"use strict";(wx["webpackJsonp"]=wx["webpackJsonp"]||[]).push([[1421],{6368:function(e,n,s){var t=s(7842),a=s(9867),c=s(1212),i=s(467),r=s(9379),o=s(5544),l=s(6540),u=s(118),d=s(758),m=s.n(d),h=s(3247),f=s(3),g=s(1281),x=s(4848),p=function(e){var n=e.visible,s=e.type,t=e.onConfirm,a=e.onGoScan,c=e.onClose,i=(0,l.useState)(!1),r=(0,o.A)(i,2),d=r[0],m=r[1],h="quote"===s?"\u5efa\u8bae\u5148\u68c0\u6d4b\u88c5\u4fee\u516c\u53f8\u98ce\u9669\uff0c\u518d\u4e0a\u4f20\u62a5\u4ef7\u5355":"\u5efa\u8bae\u5148\u68c0\u6d4b\u88c5\u4fee\u516c\u53f8\u98ce\u9669\uff0c\u518d\u4e0a\u4f20\u5408\u540c";if(!n)return null;var f=function(){t(d)};return(0,x.jsx)(u.Ss,{className:"upload-confirm-mask",onClick:c,children:(0,x.jsxs)(u.Ss,{className:"upload-confirm-modal",onClick:function(e){return e.stopPropagation()},children:[(0,x.jsx)(u.EY,{className:"close-btn",onClick:c,children:"\xd7"}),(0,x.jsx)(u.EY,{className:"modal-title",children:"\u6e29\u99a8\u63d0\u793a"}),(0,x.jsx)(u.EY,{className:"modal-content",children:h}),(0,x.jsxs)(u.Ss,{className:"checkbox-row",onClick:function(){return m(!d)},children:[(0,x.jsx)(u.EY,{className:"checkbox ".concat(d?"checked":""),children:d?"\u2713":""}),(0,x.jsx)(u.EY,{className:"checkbox-label",children:"\u4e0d\u518d\u63d0\u793a"})]}),(0,x.jsxs)(u.Ss,{className:"modal-btns",children:[(0,x.jsx)(u.Ss,{className:"btn secondary",onClick:a,children:(0,x.jsx)(u.EY,{children:"\u53bb\u68c0\u6d4b"})}),(0,x.jsx)(u.Ss,{className:"btn primary",onClick:f,children:(0,x.jsx)(u.EY,{children:"\u7ee7\u7eed\u4e0a\u4f20"})})]})]})})},S=p,j=[{label:"\u5317\u4eac",value:"\u5317\u4eac\u5e02"},{label:"\u4e0a\u6d77",value:"\u4e0a\u6d77\u5e02"},{label:"\u5e7f\u5dde",value:"\u5e7f\u5dde\u5e02"},{label:"\u6df1\u5733",value:"\u6df1\u5733\u5e02"},{label:"\u676d\u5dde",value:"\u676d\u5dde\u5e02"}],v={"\u5e7f\u4e1c":["\u5e7f\u5dde\u5e02","\u6df1\u5733\u5e02","\u4e1c\u839e\u5e02","\u4f5b\u5c71\u5e02","\u73e0\u6d77\u5e02","\u60e0\u5dde\u5e02","\u4e2d\u5c71\u5e02","\u6c5f\u95e8\u5e02","\u6e5b\u6c5f\u5e02","\u8302\u540d\u5e02","\u8087\u5e86\u5e02","\u6885\u5dde\u5e02","\u6c55\u5c3e\u5e02","\u6cb3\u6e90\u5e02","\u9633\u6c5f\u5e02","\u6e05\u8fdc\u5e02","\u6f6e\u5dde\u5e02","\u63ed\u9633\u5e02","\u4e91\u6d6e\u5e02"],"\u5317\u4eac":["\u5317\u4eac\u5e02"],"\u4e0a\u6d77":["\u4e0a\u6d77\u5e02"],"\u6d59\u6c5f":["\u676d\u5dde\u5e02","\u5b81\u6ce2\u5e02","\u6e29\u5dde\u5e02","\u5609\u5174\u5e02","\u6e56\u5dde\u5e02","\u7ecd\u5174\u5e02","\u91d1\u534e\u5e02","\u8862\u5dde\u5e02","\u821f\u5c71\u5e02","\u53f0\u5dde\u5e02","\u4e3d\u6c34\u5e02"],"\u6c5f\u82cf":["\u5357\u4eac\u5e02","\u82cf\u5dde\u5e02","\u65e0\u9521\u5e02","\u5e38\u5dde\u5e02","\u5357\u901a\u5e02","\u626c\u5dde\u5e02","\u5f90\u5dde\u5e02","\u9547\u6c5f\u5e02","\u6cf0\u5dde\u5e02","\u76d0\u57ce\u5e02","\u8fde\u4e91\u6e2f\u5e02","\u6dee\u5b89\u5e02","\u5bbf\u8fc1\u5e02"],"\u56db\u5ddd":["\u6210\u90fd\u5e02","\u7ef5\u9633\u5e02","\u5fb7\u9633\u5e02","\u5357\u5145\u5e02","\u5b9c\u5bbe\u5e02","\u81ea\u8d21\u5e02","\u4e50\u5c71\u5e02","\u6cf8\u5dde\u5e02","\u8fbe\u5dde\u5e02","\u5185\u6c5f\u5e02","\u9042\u5b81\u5e02","\u6500\u679d\u82b1\u5e02","\u7709\u5c71\u5e02","\u5e7f\u5b89\u5e02","\u8d44\u9633\u5e02","\u51c9\u5c71\u5dde"],"\u6e56\u5317":["\u6b66\u6c49\u5e02","\u5b9c\u660c\u5e02","\u8944\u9633\u5e02","\u8346\u5dde\u5e02","\u5341\u5830\u5e02","\u9ec4\u77f3\u5e02","\u8346\u95e8\u5e02","\u9102\u5dde\u5e02","\u5b5d\u611f\u5e02","\u9ec4\u5188\u5e02","\u54b8\u5b81\u5e02","\u968f\u5dde\u5e02","\u6069\u65bd\u5dde"],"\u9655\u897f":["\u897f\u5b89\u5e02","\u54b8\u9633\u5e02","\u5b9d\u9e21\u5e02","\u6e2d\u5357\u5e02","\u6c49\u4e2d\u5e02","\u6986\u6797\u5e02","\u5ef6\u5b89\u5e02","\u5b89\u5eb7\u5e02","\u5546\u6d1b\u5e02","\u94dc\u5ddd\u5e02"],"\u5c71\u4e1c":["\u6d4e\u5357\u5e02","\u9752\u5c9b\u5e02","\u70df\u53f0\u5e02","\u6f4d\u574a\u5e02","\u4e34\u6c82\u5e02","\u6dc4\u535a\u5e02","\u6d4e\u5b81\u5e02","\u6cf0\u5b89\u5e02","\u5a01\u6d77\u5e02","\u5fb7\u5dde\u5e02","\u804a\u57ce\u5e02","\u6ee8\u5dde\u5e02","\u83cf\u6cfd\u5e02","\u67a3\u5e84\u5e02","\u65e5\u7167\u5e02","\u4e1c\u8425\u5e02"],"\u6cb3\u5357":["\u90d1\u5dde\u5e02","\u6d1b\u9633\u5e02","\u5357\u9633\u5e02","\u8bb8\u660c\u5e02","\u5468\u53e3\u5e02","\u5546\u4e18\u5e02","\u65b0\u4e61\u5e02","\u5b89\u9633\u5e02","\u4fe1\u9633\u5e02","\u5f00\u5c01\u5e02","\u5e73\u9876\u5c71\u5e02","\u9a7b\u9a6c\u5e97\u5e02","\u7126\u4f5c\u5e02","\u6f2f\u6cb3\u5e02","\u6fee\u9633\u5e02","\u4e09\u95e8\u5ce1\u5e02","\u9e64\u58c1\u5e02","\u8bb8\u660c\u5e02"],"\u798f\u5efa":["\u798f\u5dde\u5e02","\u53a6\u95e8\u5e02","\u6cc9\u5dde\u5e02","\u6f33\u5dde\u5e02","\u8386\u7530\u5e02","\u9f99\u5ca9\u5e02","\u4e09\u660e\u5e02","\u5357\u5e73\u5e02","\u5b81\u5fb7\u5e02"],"\u6e56\u5357":["\u957f\u6c99\u5e02","\u682a\u6d32\u5e02","\u6e58\u6f6d\u5e02","\u8861\u9633\u5e02","\u5cb3\u9633\u5e02","\u5e38\u5fb7\u5e02","\u90b5\u9633\u5e02","\u76ca\u9633\u5e02","\u5a04\u5e95\u5e02","\u90f4\u5dde\u5e02","\u6c38\u5dde\u5e02","\u6000\u5316\u5e02","\u5f20\u5bb6\u754c\u5e02","\u6e58\u897f\u5dde"]},N=Object.keys(v),y="\u5e7f\u4e1c",w=N.flatMap(function(e){return v[e]}),k=function(e){var n=e.visible,s=e.onConfirm,t=e.onClose,a=(0,l.useState)(""),c=(0,o.A)(a,2),i=c[0],r=c[1],d=(0,l.useState)(y),h=(0,o.A)(d,2),f=h[0],g=h[1],p=(0,l.useState)(""),S=(0,o.A)(p,2),k=S[0],b=S[1],A=(0,l.useState)("loading"),E=(0,o.A)(A,2),C=E[0],Y=E[1],T=(0,l.useState)(""),_=(0,o.A)(T,2),I=_[0],M=_[1],D=(0,l.useMemo)(function(){var e=i.trim().toLowerCase();return e?w.filter(function(n){return n.toLowerCase().includes(e)||n.replace(/\u5e02$/,"").toLowerCase().includes(e)}):[]},[i]),q=f&&v[f]||[];(0,l.useEffect)(function(){n&&(r(""),b(""),g(y),m().getLocation({type:"wgs84",success:function(){Y("success");var e=m().getStorageSync("selected_city");M(e||"\u5f53\u524d\u57ce\u5e02"),e&&e.trim()&&b(e.trim())},fail:function(){return Y("fail")}}))},[n]);var B=function(){console.log("[\u57ce\u5e02\u9009\u62e9] handleConfirm \u88ab\u8c03\u7528",{selectedCity:k,keyword:i,filteredCities:D});var e=k||(i.trim()&&1===D.length?D[0]:"");console.log("[\u57ce\u5e02\u9009\u62e9] \u6700\u7ec8\u9009\u62e9\u7684\u57ce\u5e02",e),e?(m().setStorageSync("selected_city",e),console.log("[\u57ce\u5e02\u9009\u62e9] \u5df2\u4fdd\u5b58\u57ce\u5e02\u5230storage",e),s&&(console.log("[\u57ce\u5e02\u9009\u62e9] \u8c03\u7528onConfirm\u56de\u8c03",e),s(e)),m().showToast({title:"\u5df2\u9009\u62e9".concat(e),icon:"success",duration:2e3})):m().showToast({title:"\u8bf7\u5148\u9009\u62e9\u4e00\u4e2a\u57ce\u5e02",icon:"none",duration:2e3})},F=function(){t&&t()},P=!!k||i.trim()&&1===D.length;return(0,l.useEffect)(function(){n&&console.log("[\u57ce\u5e02\u9009\u62e9] \u72b6\u6001\u66f4\u65b0",{selectedCity:k,hasSelection:P,keyword:i,filteredCities:D.length})},[k,P,i,D.length,n]),n?(0,x.jsx)(u.Ss,{className:"city-picker-modal-mask",onClick:F,children:(0,x.jsxs)(u.Ss,{className:"city-picker-modal",onClick:function(e){return e.stopPropagation()},children:[(0,x.jsxs)(u.Ss,{className:"city-picker-header",children:[(0,x.jsx)(u.EY,{className:"city-picker-title",children:"\u9009\u62e9\u57ce\u5e02"}),(0,x.jsx)(u.Ss,{className:"city-picker-close",onClick:F,children:(0,x.jsx)(u.EY,{children:"\u2715"})})]}),(0,x.jsx)(u.BM,{scrollY:!0,className:"city-picker-content-outer",enhanced:!0,showScrollbar:!1,children:(0,x.jsxs)(u.Ss,{className:"city-picker-content",children:[(0,x.jsxs)(u.Ss,{className:"location-tip",children:["loading"===C&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(u.EY,{className:"location-icon",children:"\ud83d\udccd"}),(0,x.jsx)(u.EY,{className:"location-text loading",children:"\u5b9a\u4f4d\u4e2d..."})]}),"success"===C&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(u.EY,{className:"location-icon",children:"\ud83d\udccd"}),(0,x.jsx)(u.EY,{className:"location-text",children:"\u5f53\u524d\u5b9a\u4f4d\u57ce\u5e02\uff1a"}),(0,x.jsx)(u.EY,{className:"location-city",children:I})]}),"fail"===C&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(u.EY,{className:"location-icon",children:"\u26a0\ufe0f"}),(0,x.jsx)(u.EY,{className:"location-text fail",children:"\u5b9a\u4f4d\u5931\u8d25\uff0c\u8bf7\u624b\u52a8\u9009\u62e9\u57ce\u5e02"})]})]}),(0,x.jsxs)(u.Ss,{className:"hot-section",children:[(0,x.jsx)(u.EY,{className:"section-title",children:"\u70ed\u95e8\u57ce\u5e02"}),(0,x.jsx)(u.Ss,{className:"hot-tags",children:j.map(function(e){return(0,x.jsx)(u.Ss,{className:"hot-tag ".concat(k===e.value?"active":""),onClick:function(n){n.stopPropagation(),console.log("[\u57ce\u5e02\u9009\u62e9] \u70b9\u51fb\u70ed\u95e8\u57ce\u5e02",e.value),b(e.value)},children:(0,x.jsx)(u.EY,{children:e.label})},e.value)})})]}),(0,x.jsxs)(u.Ss,{className:"search-section",children:[(0,x.jsxs)(u.Ss,{className:"search-wrap",children:[(0,x.jsx)(u.EY,{className:"search-icon",children:"\ud83d\udd0d"}),(0,x.jsx)(u.pd,{className:"search-input",placeholder:"\u8f93\u5165\u57ce\u5e02\u540d\u6216\u62fc\u97f3\u641c\u7d22",placeholderClass:"search-placeholder",value:i,onInput:function(e){var n;return r((null===(n=e.detail)||void 0===n?void 0:n.value)||"")}})]}),i.trim()&&(0,x.jsx)(u.Ss,{className:"search-result-wrap",children:0===D.length?(0,x.jsx)(u.EY,{className:"search-no-result",children:"\u672a\u627e\u5230\u76f8\u5173\u57ce\u5e02"}):(0,x.jsx)(u.Ss,{className:"search-result-list",children:D.map(function(e){return(0,x.jsx)(u.Ss,{className:"search-result-item ".concat(k===e?"active":""),onClick:function(){return b(e)},children:(0,x.jsx)(u.EY,{children:e})},e)})})})]}),!i.trim()&&(0,x.jsx)(u.Ss,{className:"pick-section",children:(0,x.jsxs)(u.Ss,{className:"pick-row",children:[(0,x.jsx)(u.BM,{scrollY:!0,className:"province-list",enhanced:!0,showScrollbar:!1,children:N.map(function(e){return(0,x.jsx)(u.Ss,{className:"province-item ".concat(f===e?"active":""),onClick:function(){g(e),b("")},children:(0,x.jsx)(u.EY,{children:e})},e)})}),(0,x.jsx)(u.BM,{scrollY:!0,className:"city-list",enhanced:!0,showScrollbar:!1,children:q.map(function(e){return(0,x.jsx)(u.Ss,{className:"city-item ".concat(k===e?"active":""),onClick:function(){return b(e)},children:(0,x.jsx)(u.EY,{children:e})},e)})})]})})]})}),(0,x.jsx)(u.Ss,{className:"city-picker-footer",style:{position:"relative",zIndex:100},children:(0,x.jsx)(u.Ss,{className:"confirm-btn ".concat(P?"active":""),onClick:function(e){e.stopPropagation(),console.log("[\u57ce\u5e02\u9009\u62e9] \u70b9\u51fb\u786e\u8ba4\u6309\u94ae",{hasSelection:P,selectedCity:k,keyword:i,filteredCities:D}),P?B():(console.log("[\u57ce\u5e02\u9009\u62e9] \u6ca1\u6709\u9009\u62e9\u57ce\u5e02\uff0c\u663e\u793a\u63d0\u793a"),m().showToast({title:"\u8bf7\u5148\u9009\u62e9\u4e00\u4e2a\u57ce\u5e02",icon:"none",duration:2e3}))},children:(0,x.jsx)(u.EY,{className:"btn-text",children:"\u786e\u8ba4\u9009\u62e9"})})})]})}):null},b=k,A=s(436),E=s(4746),C=function(e){var n=e.showDragHint,s=void 0===n||n,t=e.initialPosition,a=void 0===t?{x:20,y:200}:t,r=e.fixedMode,d=void 0!==r&&r,h=(e.fixedContainerClassName,(0,l.useState)(a)),f=(0,o.A)(h,2),g=f[0],p=f[1],S=(0,l.useState)(!1),j=(0,o.A)(S,2),v=j[0],N=j[1],y=(0,l.useState)(!1),w=(0,o.A)(y,2),k=w[0],b=w[1],C=(0,l.useState)(""),Y=(0,o.A)(C,2),T=Y[0],_=Y[1],I=(0,l.useState)(!1),M=(0,o.A)(I,2),D=M[0],q=M[1],B=(0,l.useState)(s),F=(0,o.A)(B,2),P=F[0],L=F[1],R=(0,l.useState)(!0),X=(0,o.A)(R,2),z=X[0],V=X[1],W=(0,l.useState)(!0),$=(0,o.A)(W,2),G=$[0],H=$[1],J=(0,l.useState)(!1),O=(0,o.A)(J,2),U=O[0],K=O[1],Q=(0,l.useState)(""),Z=(0,o.A)(Q,2),ee=Z[0],ne=Z[1],se=(0,l.useState)([]),te=(0,o.A)(se,2),ae=te[0],ce=te[1],ie=(0,l.useState)(!1),re=(0,o.A)(ie,2),oe=re[0],le=re[1],ue=(0,l.useRef)({x:0,y:0}),de=(0,l.useRef)(null),me=(0,l.useRef)(null),he=(0,l.useRef)(null);(0,l.useEffect)(function(){var e=m().getStorageSync("has_seen_designer_avatar");e?(V(!1),L(!1)):(V(!0),m().setStorageSync("has_seen_designer_avatar","1")),d&&H(!0)},[d]);var fe=function(e){if(!d){var n=e.touches[0];ue.current={x:n.clientX-g.x,y:n.clientY-g.y},N(!0),L(!1),H(!1)}},ge=function(e){if(v&&!d){var n=e.touches[0],s=n.clientX-ue.current.x,t=n.clientY-ue.current.y,a=m().getSystemInfoSync().windowWidth,c=m().getSystemInfoSync().windowHeight,i=60,r=Math.max(0,Math.min(s,a-i)),o=Math.max(0,Math.min(t,c-i));p({x:r,y:o})}},xe=function(){N(!1),m().setStorageSync("designer_avatar_position",JSON.stringify(g))},pe=function(){var e=m().getStorageSync("token")||m().getStorageSync("access_token");return!!e},Se=function(){var e=(0,i.A)((0,c.A)().m(function e(){return(0,c.A)().w(function(e){while(1)switch(e.n){case 0:if(!v){e.n=1;break}return e.a(2);case 1:if(K(!0),H(!1),d&&!U&&L(!0),pe()){e.n=2;break}return m().showModal({title:"\u8bf7\u5148\u767b\u5f55",content:"\u4f7f\u7528AI\u8bbe\u8ba1\u5e08\u529f\u80fd\u9700\u8981\u5148\u767b\u5f55\u8d26\u53f7",confirmText:"\u53bb\u767b\u5f55",cancelText:"\u53d6\u6d88",success:function(e){e.confirm&&m().switchTab({url:"/pages/profile/index"})}}),e.a(2);case 2:if(b(!0),L(!1),ee){e.n=3;break}return e.n=3,je();case 3:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),je=function(){var e=(0,i.A)((0,c.A)().m(function e(){var n,s,t,a,i,r,o,l,u;return(0,c.A)().w(function(e){while(1)switch(e.p=e.n){case 0:if(pe()){e.n=1;break}return b(!1),m().showToast({title:"\u8bf7\u5148\u767b\u5f55",icon:"none"}),e.a(2);case 1:return e.p=1,le(!0),e.n=2,E.designerApi.createChatSession();case 2:n=e.v,ne(n.session_id),ce(n.messages||[]),n.messages&&0!==n.messages.length||(s={role:"assistant",content:"\u60a8\u597d\uff01\u6211\u662f\u60a8\u7684AI\u88c5\u4fee\u8bbe\u8ba1\u5e08 - \u6f2b\u6e38\u89c6\u9891\u751f\u6210\u5668\uff01\u6211\u53ef\u4ee5\u6839\u636e\u60a8\u7684\u6237\u578b\u56fe\u751f\u6210\u88c5\u4fee\u6548\u679c\u56fe\u548c\u6f2b\u6e38\u89c6\u9891\u3002\u8bf7\u4e0a\u4f20\u60a8\u7684\u6237\u578b\u56fe\u5f00\u59cb\u4f53\u9a8c\u5427\uff01",timestamp:Date.now()/1e3},ce([s])),e.n=5;break;case 3:if(e.p=3,u=e.v,console.error("\u521b\u5efa\u804a\u5929session\u5931\u8d25:",u),o=401===u.statusCode||401===u.code||u.response&&401===u.response.status||(null===(t=u.message)||void 0===t?void 0:t.includes("\u672a\u6388\u6743"))||(null===(a=u.message)||void 0===a?void 0:a.includes("Unauthorized"))||(null===(i=u.message)||void 0===i?void 0:i.includes("\u767b\u5f55"))||(null===(r=u.message)||void 0===r?void 0:r.includes("\u8ba4\u8bc1")),!o){e.n=4;break}return console.log("401\u9519\u8bef\u5df2\u7531postWithAuth\u5904\u7406\uff0c\u5173\u95ed\u5bf9\u8bdd\u6846\uff0c\u4e0d\u663e\u793a\u9519\u8bef\u63d0\u793a"),b(!1),e.a(2);case 4:m().showToast({title:u.message||"\u521b\u5efa\u5bf9\u8bdd\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5",icon:"none"}),l={role:"assistant",content:"\u60a8\u597d\uff01\u6211\u662f\u60a8\u7684AI\u88c5\u4fee\u8bbe\u8ba1\u5e08 - \u6f2b\u6e38\u89c6\u9891\u751f\u6210\u5668\uff01\u6211\u53ef\u4ee5\u6839\u636e\u60a8\u7684\u6237\u578b\u56fe\u751f\u6210\u88c5\u4fee\u6548\u679c\u56fe\u548c\u6f2b\u6e38\u89c6\u9891\u3002\u8bf7\u4e0a\u4f20\u60a8\u7684\u6237\u578b\u56fe\u5f00\u59cb\u4f53\u9a8c\u5427\uff01",timestamp:Date.now()/1e3},ce([l]);case 5:return e.p=5,le(!1),e.f(5);case 6:return e.a(2)}},e,null,[[1,3,5,6]])}));return function(){return e.apply(this,arguments)}}(),ve=function(){b(!1),_("")},Ne=function(){var e=(0,i.A)((0,c.A)().m(function e(){var n,s,t,a,i,r,o,l;return(0,c.A)().w(function(e){while(1)switch(e.p=e.n){case 0:if(T.trim()&&ee){e.n=1;break}return m().showToast({title:"\u8bf7\u8f93\u5165\u6d88\u606f",icon:"none"}),e.a(2);case 1:if(pe()){e.n=2;break}return m().showModal({title:"\u8bf7\u5148\u767b\u5f55",content:"\u53d1\u9001\u6d88\u606f\u9700\u8981\u5148\u767b\u5f55\u8d26\u53f7",confirmText:"\u53bb\u767b\u5f55",cancelText:"\u53d6\u6d88",success:function(e){e.confirm&&m().switchTab({url:"/pages/profile/index"})}}),e.a(2);case 2:return n=T.trim(),_(""),s={role:"user",content:n,timestamp:Date.now()/1e3},ce(function(e){return[].concat((0,A.A)(e),[s])}),q(!0),e.p=3,e.n=4,E.designerApi.sendChatMessage(ee,n);case 4:t=e.v,a={role:"assistant",content:t.answer,timestamp:Date.now()/1e3},ce(function(e){return[].concat((0,A.A)(e),[a])}),setTimeout(function(){if(he.current)try{var e,n;null===(e=(n=he.current).scrollToBottom)||void 0===e||e.call(n)}catch(e){if(console.log("\u6eda\u52a8\u5230\u5e95\u90e8\u5931\u8d25:",e),me.current){var s=me.current;s&&1===s.nodeType&&s.scrollIntoView&&s.scrollIntoView({behavior:"smooth",block:"end"})}}},100),e.n=6;break;case 5:e.p=5,l=e.v,console.error("\u53d1\u9001\u6d88\u606f\u5931\u8d25:",l),401===l.statusCode||null!==(i=l.message)&&void 0!==i&&i.includes("\u672a\u6388\u6743")||null!==(r=l.message)&&void 0!==r&&r.includes("\u767b\u5f55")?console.log("\u53d1\u9001\u6d88\u606f\u65f6401\u9519\u8bef\u5df2\u7531postWithAuth\u5904\u7406"):(m().showToast({title:l.message||"\u53d1\u9001\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5",icon:"none"}),o={role:"assistant",content:"\u62b1\u6b49\uff0c\u6211\u6682\u65f6\u65e0\u6cd5\u56de\u7b54\u60a8\u7684\u95ee\u9898\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002",timestamp:Date.now()/1e3},ce(function(e){return[].concat((0,A.A)(e),[o])}));case 6:return e.p=6,q(!1),e.f(6);case 7:return e.a(2)}},e,null,[[3,5,6,7]])}));return function(){return e.apply(this,arguments)}}(),ye=["\u73b0\u4ee3\u7b80\u7ea6\u98ce\u683c\u7684\u7279\u70b9\u662f\u4ec0\u4e48\uff1f","\u5c0f\u6237\u578b\u5982\u4f55\u8bbe\u8ba1\u663e\u5f97\u7a7a\u95f4\u66f4\u5927\uff1f","\u88c5\u4fee\u9884\u7b97\u600e\u4e48\u5206\u914d\u6bd4\u8f83\u5408\u7406\uff1f","\u9009\u62e9\u5730\u677f\u8fd8\u662f\u74f7\u7816\u6bd4\u8f83\u597d\uff1f","\u53a8\u623f\u88c5\u4fee\u8981\u6ce8\u610f\u54ea\u4e9b\u7ec6\u8282\uff1f"],we=function(){var e=(0,i.A)((0,c.A)().m(function e(){var n,s,t,a,i,r,o,l,u,d,h,f,g,x,p,S;return(0,c.A)().w(function(e){while(1)switch(e.p=e.n){case 0:if(pe()){e.n=1;break}return m().showModal({title:"\u8bf7\u5148\u767b\u5f55",content:"\u4e0a\u4f20\u56fe\u7247\u9700\u8981\u5148\u767b\u5f55\u8d26\u53f7",confirmText:"\u53bb\u767b\u5f55",cancelText:"\u53d6\u6d88",success:function(e){e.confirm&&m().switchTab({url:"/pages/profile/index"})}}),e.a(2);case 1:return e.p=1,e.n=2,m().chooseImage({count:1,sizeType:["compressed"],sourceType:["album","camera"]});case 2:if(n=e.v,!(n.tempFilePaths.length>0)){e.n=16;break}return s=n.tempFilePaths[0],t="designer_".concat(Date.now(),".jpg"),m().showLoading({title:"\u4e0a\u4f20\u6237\u578b\u56fe\u4e2d..."}),e.p=3,e.n=4,E.designerApi.uploadImage(s,t);case 4:if(a=e.v,!a.success||!a.image_url){e.n=13;break}if(m().hideLoading(),m().showToast({title:"\u6237\u578b\u56fe\u4e0a\u4f20\u6210\u529f\uff01",icon:"success",duration:2e3}),i={role:"user",content:"\ud83d\udcf8 \u5df2\u4e0a\u4f20\u6237\u578b\u56fe\uff0c\u8bf7\u5e2e\u6211\u5206\u6790\u4e00\u4e0b",timestamp:Date.now()/1e3},ce(function(e){return[].concat((0,A.A)(e),[i])}),!ee){e.n=10;break}return q(!0),e.p=5,e.n=6,E.designerApi.sendChatMessage(ee,"\u8bf7\u5e2e\u6211\u5206\u6790\u4e00\u4e0b\u8fd9\u4e2a\u6237\u578b\u56fe\uff0c\u7ed9\u51fa\u88c5\u4fee\u5efa\u8bae\u548c\u6548\u679c\u56fe\u751f\u6210\u601d\u8def\u3002",[a.image_url]);case 6:r=e.v,o={role:"assistant",content:r.answer,timestamp:Date.now()/1e3},ce(function(e){return[].concat((0,A.A)(e),[o])}),e.n=8;break;case 7:e.p=7,x=e.v,console.error("\u53d1\u9001\u56fe\u7247\u6d88\u606f\u5931\u8d25:",x),l={role:"assistant",content:"\u611f\u8c22\u4e0a\u4f20\u6237\u578b\u56fe\uff01\u6211\u6b63\u5728\u5206\u6790\u60a8\u7684\u6237\u578b...\n\n\u6237\u578b\u56fe\u5206\u6790\u3001\u6548\u679c\u56fe\u751f\u6210\u548c\u6f2b\u6e38\u89c6\u9891\u529f\u80fd\u5df2\u4e0a\u7ebf\uff0c\u6211\u53ef\u4ee5\u4e3a\u60a8\u63d0\u4f9b\u4e13\u4e1a\u7684\u88c5\u4fee\u5efa\u8bae\uff01",timestamp:Date.now()/1e3},ce(function(e){return[].concat((0,A.A)(e),[l])});case 8:return e.p=8,q(!1),e.f(8);case 9:e.n=12;break;case 10:return e.n=11,je();case 11:u={role:"assistant",content:"\u611f\u8c22\u4e0a\u4f20\u6237\u578b\u56fe\uff01\u6211\u6b63\u5728\u5206\u6790\u60a8\u7684\u6237\u578b...\n\n\u6237\u578b\u56fe\u5206\u6790\u3001\u6548\u679c\u56fe\u751f\u6210\u548c\u6f2b\u6e38\u89c6\u9891\u529f\u80fd\u5df2\u4e0a\u7ebf\uff0c\u6211\u53ef\u4ee5\u4e3a\u60a8\u63d0\u4f9b\u4e13\u4e1a\u7684\u88c5\u4fee\u5efa\u8bae\uff01",timestamp:Date.now()/1e3},ce(function(e){return[].concat((0,A.A)(e),[u])});case 12:e.n=14;break;case 13:m().hideLoading(),m().showToast({title:a.error_message||"\u4e0a\u4f20\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5",icon:"none",duration:3e3});case 14:e.n=16;break;case 15:e.p=15,p=e.v,m().hideLoading(),console.error("\u4e0a\u4f20\u56fe\u7247\u5931\u8d25:",p),401===p.statusCode||null!==(d=p.message)&&void 0!==d&&d.includes("\u672a\u6388\u6743")||null!==(h=p.message)&&void 0!==h&&h.includes("\u767b\u5f55")?console.log("\u4e0a\u4f20\u56fe\u7247\u65f6401\u9519\u8bef\u5df2\u5904\u7406"):m().showToast({title:p.message||"\u4e0a\u4f20\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5\u7f51\u7edc",icon:"none",duration:3e3}),f={role:"user",content:"\ud83d\udcf8 \u5c1d\u8bd5\u4e0a\u4f20\u6237\u578b\u56fe\uff08\u4e0a\u4f20\u5931\u8d25\uff09",timestamp:Date.now()/1e3},ce(function(e){return[].concat((0,A.A)(e),[f])}),g={role:"assistant",content:"\u6237\u578b\u56fe\u4e0a\u4f20\u529f\u80fd\u5df2\u4e0a\u7ebf\uff01\u4e0b\u6b21\u8bf7\u518d\u8bd5\u4e00\u4e0b\u4e0a\u4f20\u60a8\u7684\u6237\u578b\u56fe\uff0c\u6211\u53ef\u4ee5\u4e3a\u60a8\u63d0\u4f9b\u4e13\u4e1a\u7684\u88c5\u4fee\u5206\u6790\u548c\u6548\u679c\u56fe\u751f\u6210\u5efa\u8bae\u3002",timestamp:Date.now()/1e3},ce(function(e){return[].concat((0,A.A)(e),[g])});case 16:e.n=18;break;case 17:e.p=17,S=e.v,console.error("\u9009\u62e9\u56fe\u7247\u5931\u8d25:",S),m().hideLoading(),m().showToast({title:S.errMsg||"\u9009\u62e9\u56fe\u7247\u5931\u8d25",icon:"none"});case 18:return e.a(2)}},e,null,[[5,7,8,9],[3,15],[1,17]])}));return function(){return e.apply(this,arguments)}}(),ke=function(e){_(e)},be=function(){var e=(0,i.A)((0,c.A)().m(function e(){var n,s,t,a;return(0,c.A)().w(function(e){while(1)switch(e.p=e.n){case 0:if(ee){e.n=1;break}return e.a(2);case 1:if(pe()){e.n=2;break}return m().showModal({title:"\u8bf7\u5148\u767b\u5f55",content:"\u6e05\u7a7a\u5bf9\u8bdd\u9700\u8981\u5148\u767b\u5f55\u8d26\u53f7",confirmText:"\u53bb\u767b\u5f55",cancelText:"\u53d6\u6d88",success:function(e){e.confirm&&m().switchTab({url:"/pages/profile/index"})}}),e.a(2);case 2:return e.p=2,e.n=3,E.designerApi.clearChatHistory(ee);case 3:n={role:"assistant",content:"\u5bf9\u8bdd\u5df2\u6e05\u7a7a\uff01\u6211\u662f\u60a8\u7684AI\u88c5\u4fee\u8bbe\u8ba1\u5e08 - \u6f2b\u6e38\u89c6\u9891\u751f\u6210\u5668\uff01\u6211\u53ef\u4ee5\u6839\u636e\u60a8\u7684\u6237\u578b\u56fe\u751f\u6210\u88c5\u4fee\u6548\u679c\u56fe\u548c\u6f2b\u6e38\u89c6\u9891\u3002\u8bf7\u4e0a\u4f20\u60a8\u7684\u6237\u578b\u56fe\u5f00\u59cb\u4f53\u9a8c\u5427\uff01",timestamp:Date.now()/1e3},ce([n]),m().showToast({title:"\u5bf9\u8bdd\u5df2\u6e05\u7a7a",icon:"success"}),e.n=5;break;case 4:e.p=4,a=e.v,console.error("\u6e05\u7a7a\u5bf9\u8bdd\u5931\u8d25:",a),401===a.statusCode||null!==(s=a.message)&&void 0!==s&&s.includes("\u672a\u6388\u6743")||null!==(t=a.message)&&void 0!==t&&t.includes("\u767b\u5f55")?console.log("\u6e05\u7a7a\u5bf9\u8bdd\u65f6401\u9519\u8bef\u5df2\u7531postWithAuth\u5904\u7406"):m().showToast({title:a.message||"\u6e05\u7a7a\u5931\u8d25",icon:"none"});case 5:return e.a(2)}},e,null,[[2,4]])}));return function(){return e.apply(this,arguments)}}();(0,l.useEffect)(function(){try{var e=m().getStorageSync("designer_avatar_position");if(e){var n=JSON.parse(e);p(n)}}catch(e){console.error("\u52a0\u8f7d\u60ac\u6d6e\u5934\u50cf\u4f4d\u7f6e\u5931\u8d25:",e)}},[]),(0,l.useEffect)(function(){if(P){var e=setTimeout(function(){L(!1)},5e3);return function(){return clearTimeout(e)}}},[P]),(0,l.useEffect)(function(){ae.length>0&&he.current&&setTimeout(function(){if(he.current)try{var e,n;null===(e=(n=he.current).scrollToBottom)||void 0===e||e.call(n)}catch(e){if(console.log("\u6eda\u52a8\u5230\u5e95\u90e8\u5931\u8d25:",e),me.current){var s=me.current;s&&1===s.nodeType&&s.scrollIntoView&&s.scrollIntoView({behavior:"smooth",block:"end"})}}},100)},[ae]);var Ae=function(e){var n=new Date(1e3*e);return"".concat(n.getHours().toString().padStart(2,"0"),":").concat(n.getMinutes().toString().padStart(2,"0"))};return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(u.Ss,{className:"floating-designer-avatar ".concat(v?"dragging":""),style:{left:"".concat(g.x,"px"),top:"".concat(g.y,"px"),transform:v?"scale(1.1)":"scale(1)"},onTouchStart:fe,onTouchMove:ge,onTouchEnd:xe,onClick:Se,ref:de,children:[(0,x.jsxs)(u.Ss,{className:"avatar-container",children:[(0,x.jsx)(u._V,{className:"avatar-image",src:"https://zhuangxiu-images-dev.oss-cn-hangzhou.aliyuncs.com/avatar/avatar.png",mode:"aspectFill"}),(0,x.jsx)(u.Ss,{className:"avatar-badge",children:"AI"})]}),G&&d&&(0,x.jsx)(u.Ss,{className:"static-hint",children:(0,x.jsx)(u.EY,{className:"static-hint-text",children:"\u8bd5\u8bd5\u548cAI\u8bbe\u8ba1\u5e08\u54a8\u8be2"})}),P&&z&&(0,x.jsxs)(u.Ss,{className:"drag-hint",children:[(0,x.jsx)(u.EY,{className:"hint-text",children:"\u8bd5\u8bd5\u62d6\u62fd\u5b83\u5230\u5408\u9002\u7684\u4f4d\u7f6e"}),(0,x.jsx)(u.Ss,{className:"hint-arrow",children:"\u2193"})]})]}),k&&(0,x.jsx)(u.Ss,{className:"designer-dialog-mask",onClick:ve,children:(0,x.jsxs)(u.Ss,{className:"designer-dialog",onClick:function(e){return e.stopPropagation()},children:[(0,x.jsxs)(u.Ss,{className:"dialog-header",children:[(0,x.jsx)(u.EY,{className:"dialog-title",children:"AI\u8bbe\u8ba1\u5e08\u804a\u5929"}),(0,x.jsxs)(u.Ss,{className:"dialog-actions",children:[(0,x.jsx)(u.$n,{className:"clear-btn",onClick:be,disabled:ae.length<=1,children:"\u6e05\u7a7a"}),(0,x.jsx)(u.Ss,{className:"dialog-close",onClick:ve,children:"\xd7"})]})]}),(0,x.jsx)(u.Ss,{className:"dialog-content",children:oe?(0,x.jsx)(u.Ss,{className:"loading-container",children:(0,x.jsx)(u.EY,{children:"\u6b63\u5728\u521d\u59cb\u5316\u5bf9\u8bdd..."})}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(u.BM,{className:"chat-messages",scrollY:!0,ref:he,scrollWithAnimation:!0,children:[ae.map(function(e,n){return(0,x.jsx)(u.Ss,{className:"message-item ".concat("user"===e.role?"user-message":"ai-message"),children:(0,x.jsxs)(u.Ss,{className:"message-content",children:[(0,x.jsx)(u.EY,{className:"message-text",children:e.content}),(0,x.jsx)(u.EY,{className:"message-time",children:Ae(e.timestamp)})]})},n)}),(0,x.jsx)(u.Ss,{ref:me})]}),ae.length<=2&&(0,x.jsx)(u.Ss,{className:"upload-hint-section",children:(0,x.jsxs)(u.Ss,{className:"upload-hint-card",children:[(0,x.jsx)(u.EY,{className:"upload-hint-icon",children:"\ud83d\udcf8"}),(0,x.jsx)(u.EY,{className:"upload-hint-title",children:"\u4e0a\u4f20\u6237\u578b\u56fe\uff0c\u4e00\u952e\u751f\u6210"}),(0,x.jsx)(u.EY,{className:"upload-hint-subtitle",children:"\u88c5\u4fee\u6548\u679c\u56fe + \u6f2b\u6e38\u89c6\u9891"}),(0,x.jsx)(u.Ss,{className:"upload-hint-btn",onClick:we,children:(0,x.jsx)(u.EY,{className:"upload-hint-btn-text",children:"\u4e0a\u4f20\u6237\u578b\u56fe"})}),(0,x.jsx)(u.EY,{className:"upload-hint-tip",children:"\u652f\u6301 JPG\u3001PNG \u683c\u5f0f\uff0c\u5efa\u8bae\u4e0a\u4f20\u6e05\u6670\u6237\u578b\u56fe"})]})}),ae.length<=2&&(0,x.jsxs)(u.Ss,{className:"quick-questions",children:[(0,x.jsx)(u.EY,{className:"quick-title",children:"\u6216\u8005\u5feb\u901f\u63d0\u95ee\uff1a"}),(0,x.jsx)(u.Ss,{className:"quick-questions-grid",children:ye.map(function(e,n){return(0,x.jsx)(u.Ss,{className:"quick-question-item",onClick:function(){return ke(e)},children:(0,x.jsx)(u.EY,{className:"quick-question-text",children:e})},n)})})]}),(0,x.jsxs)(u.Ss,{className:"input-area",children:[(0,x.jsxs)(u.Ss,{className:"input-left",children:[(0,x.jsx)(u.Ss,{className:"upload-btn",onClick:we,children:(0,x.jsx)(u.EY,{className:"upload-btn-icon",children:"\ud83d\udcf7"})}),(0,x.jsx)(u.pd,{className:"message-input",placeholder:"\u8f93\u5165\u60a8\u7684\u95ee\u9898\u6216\u4e0a\u4f20\u6237\u578b\u56fe...",value:T,onInput:function(e){return _(e.detail.value)},focus:!T,confirmType:"send",onConfirm:Ne})]}),(0,x.jsx)(u.$n,{className:"send-btn",onClick:Ne,disabled:D||!T.trim(),children:D?"\u601d\u8003\u4e2d...":"\u53d1\u9001"})]})]})}),(0,x.jsx)(u.Ss,{className:"dialog-footer",children:(0,x.jsx)(u.EY,{className:"footer-text",children:"AI\u88c5\u4fee\u8bbe\u8ba1\u5e08 - \u6f2b\u6e38\u89c6\u9891\u751f\u6210\u5668 | \u4e0a\u4f20\u6237\u578b\u56fe\u751f\u6210\u6548\u679c\u56fe+\u89c6\u9891"})})]})})]})},Y=C;function T(){var e=m().getStorageSync("selected_city");if(!e||!e.trim())return"\u5b9a\u4f4d";var n=e.replace(/\u5e02$/,"").trim();return n.charAt(0)||"\u5b9a\u4f4d"}var _="show_remind_permission_modal",I="show_city_selection_modal",M=function(){var e=(0,l.useState)(0),n=(0,o.A)(e,2),t=n[0],p=n[1],j=(0,l.useState)(!1),v=(0,o.A)(j,2),N=v[0],y=v[1],w=(0,l.useState)(!1),k=(0,o.A)(w,2),A=k[0],E=k[1],C=(0,l.useState)({visible:!1,type:"quote",url:""}),M=(0,o.A)(C,2),D=M[0],q=M[1],B=(0,l.useState)(!1),F=(0,o.A)(B,2),P=F[0],L=F[1],R=(0,l.useState)(!1),X=(0,o.A)(R,2),z=X[0],V=X[1],W=(0,l.useState)(function(){return T()}),$=(0,o.A)(W,2),G=$[0],H=$[1],J=(0,l.useRef)(!0),O=(0,l.useRef)(null);(0,l.useEffect)(function(){J.current=!0;var e=function(){try{if(!J.current)return;var e=m().getStorageSync("selected_city"),n=e&&e.replace(/\u5e02$/,"").trim().charAt(0)||"\u5b9a\u4f4d";if(!J.current)return;H(n)}catch(e){}};return O.current=setInterval(e,500),function(){J.current=!1,O.current&&(clearInterval(O.current),O.current=null)}},[]);var U=[{id:1,title:"\u82b130\u4e07\u88c5\u4fee\uff0c\u4e0d\u8be5\u9760\u8fd0\u6c14",subtitle:"AI\u5e2e\u4f60\u907f\u5751",action:"guide",image:h.wC[0]},{id:2,title:"\u88c5\u4fee\u516c\u53f8\u9760\u8c31\u5417\uff1f",subtitle:"10\u79d2AI\u6838\u9a8c",action:"company",image:h.wC[1]},{id:3,title:"\u62a5\u4ef7\u5355/\u5408\u540c\u85cf\u9677\u9631\uff1f",subtitle:"AI\u9010\u6761\u5206\u6790",action:"upload",image:h.wC[2]}],K=function(){m().navigateTo({url:"/pages/company-scan/index"})},Q=function(e,n){var s=m().getStorageSync("has_company_scan");s||A?m().navigateTo({url:n}):q({visible:!0,type:e,url:n})},Z=function(e,n){q(function(e){return(0,r.A)((0,r.A)({},e),{},{visible:!1})}),e&&(E(!0),m().setStorageSync("no_upload_prompt","1")),m().navigateTo({url:n})},ee=function(){q(function(e){return(0,r.A)((0,r.A)({},e),{},{visible:!1})}),m().navigateTo({url:"/pages/company-scan/index"})},ne=function(){return Q("quote","/pages/quote-upload/index")},se=function(){return Q("contract","/pages/contract-upload/index")};(0,l.useEffect)(function(){var e=m().getStorageSync("no_upload_prompt");e&&E(!0)},[]),(0,l.useEffect)(function(){try{var e=m().getStorageSync("selected_city"),n=e&&e.trim(),s=m().getStorageSync(I)||!n;s?(m().removeStorageSync(I),n?te():V(!0)):te()}catch(e){}},[]);var te=function(){try{m().getStorageSync(_)&&(m().removeStorageSync(_),L(!0))}catch(e){}},ae=function(e){console.log("[\u9996\u9875] \u57ce\u5e02\u9009\u62e9\u786e\u8ba4",e),V(!1);var n=m().getStorageSync("selected_city"),s=n&&n.replace(/\u5e02$/,"").trim().charAt(0)||"\u5b9a\u4f4d";H(s),console.log("[\u9996\u9875] \u66f4\u65b0\u57ce\u5e02\u663e\u793a",s),setTimeout(function(){te()},300)},ce=function(){V(!1),setTimeout(function(){te()},300)};(0,l.useEffect)(function(){var e=function(){var e=(0,i.A)((0,c.A)().m(function e(){var n,s,t,a,i,r,o,l,u;return(0,c.A)().w(function(e){while(1)switch(e.p=e.n){case 0:if(e.p=0,a=m().getStorageSync("access_token"),i=m().getStorageSync("user_id"),a){e.n=1;break}return y(!1),e.a(2);case 1:return e.n=2,m().request({url:"".concat(f.env.apiBaseUrl,"/messages/unread-count"),method:"GET",header:{Authorization:"Bearer ".concat(a),"X-User-Id":null!=i&&""!==i?String(i):"","Content-Type":"application/json"}});case 2:r=e.v,o=null!==(n=null===(s=r.data)||void 0===s?void 0:s.data)&&void 0!==n?n:r.data,l=null!==(t=null===o||void 0===o?void 0:o.count)&&void 0!==t?t:0,y(l>0),e.n=4;break;case 3:e.p=3,u=e.v,console.log("[\u9996\u9875] \u83b7\u53d6\u672a\u8bfb\u6d88\u606f\u6570\u5931\u8d25:",u),y(!1);case 4:return e.a(2)}},e,null,[[0,3]])}));return function(){return e.apply(this,arguments)}}();e()},[]),(0,d.useDidShow)(function(){return H(T())});var ie=function(){var e=m().getStorageSync("construction_start_date");e?(0,g.XS)(g.EN):m().showActionSheet({itemList:["7\u5929\u540e\u5f00\u5de5","15\u5929\u540e\u5f00\u5de5","30\u5929\u540e\u5f00\u5de5","\u9009\u62e9\u5176\u4ed6\u65e5\u671f"],success:function(e){if(3!==e.tapIndex){var n=[7,15,30][e.tapIndex],t=new Date;t.setDate(t.getDate()+n);var c=t.getFullYear()+"-"+String(t.getMonth()+1).padStart(2,"0")+"-"+String(t.getDate()).padStart(2,"0");m().setStorageSync("construction_start_date",c);var i=m().getStorageSync("access_token");i&&Promise.resolve().then(function(){return(0,a.A)(s(4746))}).then(function(e){var n=e.postWithAuth;n("/constructions/start-date",{start_date:c}).catch(function(){})}),m().showToast({title:"\u8fdb\u5ea6\u8ba1\u5212\u5df2\u66f4\u65b0",icon:"success"}),(0,g.XS)(g.EN,{defer:150})}else(0,g.XS)(g.EN,{defer:150})},fail:function(){}})},re=function(e){m().setStorageSync("construction_scroll_stage",e),(0,g.XS)(g.EN)},oe=function(){L(!1);try{"function"===typeof m().requestSubscribeMessage&&m().requestSubscribeMessage({tmplIds:[],entityIds:[],success:function(){return m().setStorageSync("remind_permission_granted",!0)},fail:function(){}}).catch(function(){})}catch(e){}},le=function(){L(!1)},ue=function(e){switch(e){case"guide":m().navigateTo({url:"/pages/guide/index"});break;case"company":K();break;case"upload":m().showActionSheet({itemList:["\u4e0a\u4f20\u62a5\u4ef7\u5355","\u4e0a\u4f20\u5408\u540c"],success:function(e){0===e.tapIndex?ne():1===e.tapIndex&&se()},fail:function(){}});break}};return(0,x.jsxs)(u.Ss,{className:"index-page",children:[(0,x.jsxs)(u.Ss,{className:"header",children:[(0,x.jsx)(u.Ss,{className:"city-entry",onClick:function(){return m().navigateTo({url:"/pages/city-picker/index"})},children:(0,x.jsx)(u.EY,{className:"city-entry-text",children:G})}),(0,x.jsx)(u.EY,{className:"title",children:"\u88c5\u4fee\u907f\u5751\u7ba1\u5bb6"}),(0,x.jsxs)(u.Ss,{className:"message-icon",onClick:function(){return m().navigateTo({url:"/pages/message/index"})},children:[(0,x.jsx)(u.EY,{className:"icon-text",children:"\ud83d\udd14"}),N&&(0,x.jsx)(u.Ss,{className:"dot"})]})]}),(0,x.jsx)(u.Ss,{className:"swiper-container",children:(0,x.jsx)(u.RC,{className:"swiper",indicatorDots:!0,indicatorColor:"rgba(255,255,255,0.4)",indicatorActiveColor:"#fff",autoplay:!0,interval:3e3,circular:!0,current:t,onChange:function(e){return p(e.detail.current)},children:U.map(function(e){return(0,x.jsx)(u.wu,{children:(0,x.jsxs)(u.Ss,{className:"swiper-item",onClick:function(){return ue(e.action)},children:[h.ih&&e.image?(0,x.jsx)(u._V,{src:e.image,className:"swiper-img",mode:"aspectFill"}):(0,x.jsx)(u.Ss,{className:"swiper-bg"}),(0,x.jsxs)(u.Ss,{className:"swiper-content",children:[(0,x.jsx)(u.EY,{className:"swiper-title",style:{color:"#FFD700"},children:e.title}),(0,x.jsx)(u.EY,{className:"swiper-subtitle",style:{color:"#FFEB3B"},children:e.subtitle})]})]})},e.id)})})}),(0,x.jsxs)(u.Ss,{className:"main-actions grid-four",children:[(0,x.jsxs)(u.Ss,{className:"action-card",onClick:K,children:[(0,x.jsx)(u.EY,{className:"action-card-icon",children:"\ud83c\udfe2"}),(0,x.jsx)(u.EY,{className:"action-card-text",children:"\u88c5\u4fee\u516c\u53f8\u68c0\u6d4b"})]}),(0,x.jsxs)(u.Ss,{className:"action-card",onClick:ne,children:[(0,x.jsx)(u.EY,{className:"action-card-icon",children:"\ud83d\udcb0"}),(0,x.jsx)(u.EY,{className:"action-card-text",children:"\u88c5\u4fee\u62a5\u4ef7\u5206\u6790"})]}),(0,x.jsxs)(u.Ss,{className:"action-card",onClick:se,children:[(0,x.jsx)(u.EY,{className:"action-card-icon",children:"\ud83d\udcdc"}),(0,x.jsx)(u.EY,{className:"action-card-text",children:"\u88c5\u4fee\u5408\u540c\u5ba1\u6838"})]}),(0,x.jsxs)(u.Ss,{className:"action-card highlight",onClick:ie,children:[(0,x.jsx)(u.EY,{className:"action-card-icon",children:"\ud83d\udd0d"}),(0,x.jsx)(u.EY,{className:"action-card-text",children:"AI\u65bd\u5de5\u9a8c\u6536"}),(0,x.jsx)(u.EY,{className:"action-card-hint",children:"6\u5927\u9636\u6bb5"})]})]}),(0,x.jsx)(u.Ss,{className:"section-label",children:(0,x.jsx)(u.EY,{children:"6\u5927\u9636\u6bb5"})}),(0,x.jsx)(u.BM,{scrollX:!0,className:"stage-quick-scroll",showScrollbar:!1,children:(0,x.jsx)(u.Ss,{className:"stage-quick-list",children:["S00\u6750\u6599","S01\u9690\u853d","S02\u6ce5\u74e6","S03\u6728\u5de5","S04\u6cb9\u6f06","S05\u6536\u5c3e"].map(function(e,n){return(0,x.jsxs)(u.Ss,{className:"stage-quick-item",onClick:function(){return re(n)},children:[(0,x.jsx)(u.EY,{className:"stage-quick-icon",children:["\ud83d\udce6","\ud83d\udd0c","\ud83e\uddf1","\ud83e\udeb5","\ud83d\udd8c","\u2705"][n]}),(0,x.jsx)(u.EY,{className:"stage-quick-text",children:e})]},n)})})}),(0,x.jsxs)(u.Ss,{className:"member-card",onClick:function(){return m().navigateTo({url:"/pages/membership/index"})},children:[(0,x.jsx)(u.EY,{className:"member-card-text",children:"6\u5927\u9636\u6bb5\u5168\u62a5\u544a\u89e3\u9501+\u65e0\u9650\u6b21AI\u63d0\u9192"}),(0,x.jsx)(u.EY,{className:"member-card-btn",children:"\u7acb\u5373\u5f00\u901a"})]}),(0,x.jsx)(u.Ss,{className:"ai-designer-fixed-container",children:(0,x.jsx)(Y,{showDragHint:!0,initialPosition:{x:0,y:0},fixedMode:!0,fixedContainerClassName:"ai-designer-fixed"})}),(0,x.jsx)(u.EY,{className:"tips-text",children:"\u672c\u5730\u88c5\u4fee\u884c\u4e1a\u89c4\u8303\u5b9e\u65f6\u66f4\u65b0\uff0cAI\u68c0\u6d4b\u66f4\u7cbe\u51c6"}),(0,x.jsx)(S,{visible:D.visible,type:D.type,onConfirm:function(e){return Z(e,D.url)},onGoScan:ee,onClose:function(){return q(function(e){return(0,r.A)((0,r.A)({},e),{},{visible:!1})})}}),(0,x.jsx)(b,{visible:z,onConfirm:ae,onClose:ce}),P&&(0,x.jsx)(u.Ss,{className:"remind-permission-mask",onClick:le,children:(0,x.jsxs)(u.Ss,{className:"remind-permission-modal",onClick:function(e){return e.stopPropagation()},children:[(0,x.jsx)(u.EY,{className:"remind-permission-title",children:"\u8fdb\u5ea6+\u6d88\u606f\u63d0\u9192"}),(0,x.jsx)(u.EY,{className:"remind-permission-desc",children:"\u5f00\u542f\u540e\uff0c6\u5927\u9636\u6bb5\u5f00\u59cb/\u9a8c\u6536\u524d\u5c06\u4e3a\u60a8\u63a8\u9001\u5fae\u4fe1\u670d\u52a1\u901a\u77e5\uff0c\u88c5\u4fee\u4e0d\u9057\u6f0f"}),(0,x.jsxs)(u.Ss,{className:"remind-permission-btns",children:[(0,x.jsx)(u.Ss,{className:"remind-permission-btn reject",onClick:le,children:(0,x.jsx)(u.EY,{children:"\u62d2\u7edd"})}),(0,x.jsx)(u.Ss,{className:"remind-permission-btn allow",onClick:oe,children:(0,x.jsx)(u.EY,{children:"\u5141\u8bb8"})})]}),(0,x.jsx)(u.EY,{className:"remind-permission-hint",children:"\u62d2\u7edd\u540e\u53ef\u5728\u3010\u6211\u7684-\u8bbe\u7f6e\u3011\u4e8c\u6b21\u5f00\u542f"})]})})]})},D=M,q={navigationBarTitleText:"\u88c5\u4fee\u907f\u5751\u7ba1\u5bb6",navigationBarBackgroundColor:"#1677FF",navigationBarTextStyle:"white",enableShareAppMessage:!0,onReachBottomDistance:50};D.enableShareAppMessage=!0;Page((0,t.createPageConfig)(D,"pages/index/index",{root:{cn:[]}},q||{}))}},function(e){var n=function(n){return e(e.s=n)};e.O(0,[6907,8096,2076],function(){return n(6368)});e.O()}]);