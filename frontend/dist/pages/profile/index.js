"use strict";(wx["webpackJsonp"]=wx["webpackJsonp"]||[]).push([[481],{5959:function(e,s,n){var a=n(7842),c=n(1212),l=n(467),i=n(5544),t=n(6540),r=n(118),o=n(758),u=n.n(o),m=n(4746),d=n(1468),x=d.wA,h=d.d4,j=n(4532),N=n(4848),f=function(){x();var e=h(function(e){return e.user.userInfo}),s=h(function(e){return e.user.isLoggedIn}),n=(0,t.useState)(!1),a=(0,i.A)(n,2),o=(a[0],a[1],(0,t.useState)(0)),d=(0,i.A)(o,2),f=d[0],v=d[1],S=(0,t.useState)(0),g=(0,i.A)(S,2),p=g[0],E=g[1],Y=(0,t.useState)(0),w=(0,i.A)(Y,2),k=w[0],b=w[1],A=function(){var e=(0,l.A)((0,c.A)().m(function e(){var s,n;return(0,c.A)().w(function(e){while(1)switch(e.p=e.n){case 0:return e.p=0,e.n=1,m.i$.getProfile();case 1:s=e.v,setUserInfo(s),e.n=3;break;case 2:e.p=2,n=e.v,console.error("\u83b7\u53d6\u7528\u6237\u4fe1\u606f\u5931\u8d25:",n);case 3:return e.a(2)}},e,null,[[0,2]])}));return function(){return e.apply(this,arguments)}}(),C=function(){var e=(0,l.A)((0,c.A)().m(function e(){var s,n,a,l,t,r;return(0,c.A)().w(function(e){while(1)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Promise.all([m.i$.getCompanyScans(),m.i$.getQuotes(),m.i$.getContracts()]);case 1:s=e.v,n=(0,i.A)(s,3),a=n[0],l=n[1],t=n[2],v((null===a||void 0===a?void 0:a.total)||0),E((null===l||void 0===l?void 0:l.total)||0),b((null===t||void 0===t?void 0:t.total)||0),e.n=3;break;case 2:e.p=2,r=e.v,console.error("\u52a0\u8f7d\u7edf\u8ba1\u6570\u636e\u5931\u8d25:",r);case 3:return e.a(2)}},e,null,[[0,2]])}));return function(){return e.apply(this,arguments)}}();(0,t.useEffect)(function(){s&&(A(),C())},[s]);var y=function(){var e=(0,l.A)((0,c.A)().m(function e(){var s,n;return(0,c.A)().w(function(e){while(1)switch(e.p=e.n){case 0:return e.p=0,e.n=1,u().login();case 1:return s=e.v,e.n=2,m.i$.login(s.code);case 2:n=e.v,u().setStorageSync("access_token",n.access_token),u().setStorageSync("user_id",n.user_id),setUserInfo(n),u().showToast({title:"\u767b\u5f55\u6210\u529f",icon:"success"}),A(),C(),e.n=4;break;case 3:e.p=3,e.v,u().showToast({title:"\u767b\u5f55\u5931\u8d25",icon:"none"});case 4:return e.a(2)}},e,null,[[0,3]])}));return function(){return e.apply(this,arguments)}}(),_=function(){u().showModal({title:"\u9000\u51fa\u767b\u5f55",content:"\u786e\u5b9a\u8981\u9000\u51fa\u767b\u5f55\u5417\uff1f",success:function(e){e.confirm&&(u().removeStorageSync("access_token"),u().removeStorageSync("user_id"),(0,j.ri)(),v(0),E(0),b(0),u().showToast({title:"\u5df2\u9000\u51fa\u767b\u5f55",icon:"success"}))}})},T=function(e){u().navigateTo({url:"/pages/history/index?type=".concat(e)})},P=function(){u().navigateTo({url:"/pages/settings/index"})},I=function(){u().navigateTo({url:"/pages/membership/index"})},B=function(){u().makePhoneCall({phoneNumber:"400-xxx-xxxx"})};return(0,N.jsxs)(r.BM,{scrollY:!0,className:"profile-page",children:[(0,N.jsx)(r.Ss,{className:"user-card",children:s?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(r._V,{className:"avatar",src:(null===e||void 0===e?void 0:e.avatar_url)||"https://via.placeholder.com/80"}),(0,N.jsxs)(r.Ss,{className:"user-info",children:[(0,N.jsx)(r.EY,{className:"nickname",children:(null===e||void 0===e?void 0:e.nickname)||"\u88c5\u4fee\u7528\u6237"}),(0,N.jsxs)(r.EY,{className:"user-id",children:["ID: ",(null===e||void 0===e?void 0:e.user_id)||"\u672a\u767b\u5f55"]})]}),(null===e||void 0===e?void 0:e.is_member)&&(0,N.jsx)(r.Ss,{className:"member-badge",children:(0,N.jsx)(r.EY,{className:"member-text",children:"VIP\u4f1a\u5458"})})]}):(0,N.jsxs)(r.Ss,{className:"login-cta",children:[(0,N.jsx)(r.EY,{className:"login-text",children:"\u767b\u5f55\u540e\u67e5\u770b\u66f4\u591a\u4fe1\u606f"}),(0,N.jsx)(r.Ss,{className:"login-btn",onClick:y,children:(0,N.jsx)(r.EY,{className:"login-btn-text",children:"\u7acb\u5373\u767b\u5f55"})})]})}),s&&(0,N.jsxs)(r.Ss,{className:"stats-section",children:[(0,N.jsxs)(r.Ss,{className:"stat-item",onClick:function(){return T("company")},children:[(0,N.jsx)(r.EY,{className:"stat-value",children:f}),(0,N.jsx)(r.EY,{className:"stat-label",children:"\u516c\u53f8\u68c0\u6d4b"})]}),(0,N.jsx)(r.Ss,{className:"stat-divider"}),(0,N.jsxs)(r.Ss,{className:"stat-item",onClick:function(){return T("quote")},children:[(0,N.jsx)(r.EY,{className:"stat-value",children:p}),(0,N.jsx)(r.EY,{className:"stat-label",children:"\u62a5\u4ef7\u5355"})]}),(0,N.jsx)(r.Ss,{className:"stat-divider"}),(0,N.jsxs)(r.Ss,{className:"stat-item",onClick:function(){return T("contract")},children:[(0,N.jsx)(r.EY,{className:"stat-value",children:k}),(0,N.jsx)(r.EY,{className:"stat-label",children:"\u5408\u540c\u5ba1\u6838"})]})]}),(0,N.jsxs)(r.Ss,{className:"menu-section",children:[s&&(0,N.jsxs)(r.Ss,{className:"menu-item",onClick:I,children:[(0,N.jsxs)(r.Ss,{className:"menu-left",children:[(0,N.jsx)(r.EY,{className:"menu-icon",children:"\ud83d\udc51"}),(0,N.jsx)(r.EY,{className:"menu-title",children:"\u4f1a\u5458\u4e2d\u5fc3"})]}),(0,N.jsx)(r.EY,{className:"menu-arrow",children:"\u203a"})]}),(0,N.jsxs)(r.Ss,{className:"menu-item",onClick:function(){return T("company")},children:[(0,N.jsxs)(r.Ss,{className:"menu-left",children:[(0,N.jsx)(r.EY,{className:"menu-icon",children:"\ud83c\udfe2"}),(0,N.jsx)(r.EY,{className:"menu-title",children:"\u68c0\u6d4b\u5386\u53f2"})]}),(0,N.jsx)(r.EY,{className:"menu-arrow",children:"\u203a"})]}),(0,N.jsxs)(r.Ss,{className:"menu-item",onClick:P,children:[(0,N.jsxs)(r.Ss,{className:"menu-left",children:[(0,N.jsx)(r.EY,{className:"menu-icon",children:"\u2699\ufe0f"}),(0,N.jsx)(r.EY,{className:"menu-title",children:"\u8bbe\u7f6e"})]}),(0,N.jsx)(r.EY,{className:"menu-arrow",children:"\u203a"})]}),(0,N.jsxs)(r.Ss,{className:"menu-item",onClick:B,children:[(0,N.jsxs)(r.Ss,{className:"menu-left",children:[(0,N.jsx)(r.EY,{className:"menu-icon",children:"\ud83d\udcde"}),(0,N.jsx)(r.EY,{className:"menu-title",children:"\u8054\u7cfb\u5ba2\u670d"})]}),(0,N.jsx)(r.EY,{className:"menu-arrow",children:"\u203a"})]}),(0,N.jsxs)(r.Ss,{className:"menu-item",children:[(0,N.jsxs)(r.Ss,{className:"menu-left",children:[(0,N.jsx)(r.EY,{className:"menu-icon",children:"\ud83d\udcd6"}),(0,N.jsx)(r.EY,{className:"menu-title",children:"\u4f7f\u7528\u5e2e\u52a9"})]}),(0,N.jsx)(r.EY,{className:"menu-arrow",children:"\u203a"})]}),(0,N.jsxs)(r.Ss,{className:"menu-item",children:[(0,N.jsxs)(r.Ss,{className:"menu-left",children:[(0,N.jsx)(r.EY,{className:"menu-icon",children:"\u2139\ufe0f"}),(0,N.jsx)(r.EY,{className:"menu-title",children:"\u5173\u4e8e\u6211\u4eec"})]}),(0,N.jsx)(r.EY,{className:"menu-arrow",children:"\u203a"})]})]}),s&&(0,N.jsx)(r.Ss,{className:"logout-section",children:(0,N.jsx)(r.Ss,{className:"logout-btn",onClick:_,children:(0,N.jsx)(r.EY,{className:"logout-text",children:"\u9000\u51fa\u767b\u5f55"})})}),(0,N.jsx)(r.Ss,{className:"version-info",children:(0,N.jsx)(r.EY,{className:"version-text",children:"\u7248\u672c 1.0.0"})})]})},v=f,S={navigationBarTitleText:"\u6211\u7684",navigationBarBackgroundColor:"#1677FF",navigationBarTextStyle:"white",enablePullDownRefresh:!0};Page((0,a.createPageConfig)(v,"pages/profile/index",{root:{cn:[]}},S||{}))}},function(e){var s=function(s){return e(e.s=s)};e.O(0,[907,96,76],function(){return s(5959)});e.O()}]);