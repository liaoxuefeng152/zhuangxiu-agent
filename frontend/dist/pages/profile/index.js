"use strict";(wx["webpackJsonp"]=wx["webpackJsonp"]||[]).push([[5862],{2579:function(e,n,i){var l=i(7842),a=i(1212),s=i(467),o=i(5544),r=i(6540),t=i(118),c=i(758),d=i.n(c),u=i(215),v=i(4532),m=i(3),h=i(4746),f=i(1281),p=i(4848),x=function(){var e=(0,u.j)(),n=(0,u.G)(function(e){return e.user.userInfo}),i=(0,u.G)(function(e){return e.user.isLoggedIn}),l=(0,r.useState)(0),c=(0,o.A)(l,2),x=(c[0],c[1]),g=(0,r.useState)(0),j=(0,o.A)(g,2),N=(j[0],j[1]),E=(0,r.useState)(0),S=(0,o.A)(E,2),k=(S[0],S[1]),Y=(0,r.useState)([]),w=(0,o.A)(Y,2),b=(w[0],w[1],m.env.apiBaseUrl),y=function(e,n){return{Authorization:"Bearer ".concat(e),"X-User-Id":String(n),"Content-Type":"application/json"}},C=function(){var n=(0,s.A)((0,a.A)().m(function n(i,l){var s,o,r,t,c,u,m,h,f,p,x,g,j,N,E,S,k,Y,w,C,A;return(0,a.A)().w(function(n){while(1)switch(n.p=n.n){case 0:if(o=null!==(s=null!==i&&void 0!==i?i:d().getStorageSync("token"))&&void 0!==s?s:d().getStorageSync("access_token"),r=null!==l&&void 0!==l?l:d().getStorageSync("user_id"),o){n.n=1;break}return n.a(2);case 1:return n.p=1,n.n=2,d().request({url:"".concat(b,"/users/profile"),method:"GET",header:y(o,null!=r?String(r):"")});case 2:m=n.v,h=null!==(t=null===(c=m.data)||void 0===c?void 0:c.data)&&void 0!==t?t:m.data,f=h,f&&(null!==(u=f.user_id)&&void 0!==u?u:f.userId)&&(C=f.member_expire,A=C?"string"===typeof C?C.slice(0,10):new Date(C).toISOString().slice(0,10):void 0,e((0,v.iA)({userId:null!==(p=f.user_id)&&void 0!==p?p:f.userId,openid:null!==(x=f.openid)&&void 0!==x?x:"",nickname:null!==(g=f.nickname)&&void 0!==g?g:"\u88c5\u4fee\u7528\u6237",avatarUrl:null!==(j=null!==(N=f.avatar_url)&&void 0!==N?N:f.avatarUrl)&&void 0!==j?j:"",phone:null!==(E=f.phone)&&void 0!==E?E:"",phoneVerified:null!==(S=f.phone_verified)&&void 0!==S&&S,isMember:null!==(k=null!==(Y=f.is_member)&&void 0!==Y?Y:f.isMember)&&void 0!==k&&k,memberExpire:A,points:null!==(w=f.points)&&void 0!==w?w:0}))),n.n=4;break;case 3:n.p=3,n.v;case 4:return n.a(2)}},n,null,[[1,3]])}));return function(e,i){return n.apply(this,arguments)}}(),A=function(){var e=(0,s.A)((0,a.A)().m(function e(n,i){var l,s,r,t,c,u,v,m,h,f,p,g;return(0,a.A)().w(function(e){while(1)switch(e.p=e.n){case 0:if(s=null!==(l=null!==n&&void 0!==n?n:d().getStorageSync("token"))&&void 0!==l?l:d().getStorageSync("access_token"),r=null!==i&&void 0!==i?i:d().getStorageSync("user_id"),s){e.n=1;break}return e.a(2);case 1:return e.p=1,v=y(s,null!=r?String(r):""),e.n=2,Promise.all([d().request({url:"".concat(b,"/companies/scans"),method:"GET",header:v}).then(function(e){var n,i,l;return null!==(n=null!==(i=null===(l=e.data)||void 0===l?void 0:l.data)&&void 0!==i?i:e.data)&&void 0!==n?n:{}}),d().request({url:"".concat(b,"/quotes/list"),method:"GET",header:v}).then(function(e){var n,i,l;return null!==(n=null!==(i=null===(l=e.data)||void 0===l?void 0:l.data)&&void 0!==i?i:e.data)&&void 0!==n?n:{}}),d().request({url:"".concat(b,"/contracts/list"),method:"GET",header:v}).then(function(e){var n,i,l;return null!==(n=null!==(i=null===(l=e.data)||void 0===l?void 0:l.data)&&void 0!==i?i:e.data)&&void 0!==n?n:{}})]);case 2:m=e.v,h=(0,o.A)(m,3),f=h[0],p=h[1],g=h[2],x(null!==(t=null===f||void 0===f?void 0:f.total)&&void 0!==t?t:0),N(null!==(c=null===p||void 0===p?void 0:p.total)&&void 0!==c?c:0),k(null!==(u=null===g||void 0===g?void 0:g.total)&&void 0!==u?u:0),e.n=4;break;case 3:e.p=3,e.v,x(0),N(0),k(0);case 4:return e.a(2)}},e,null,[[1,3]])}));return function(n,i){return e.apply(this,arguments)}}();(0,r.useEffect)(function(){i&&(C(),A())},[i]);var T=function(){var n=(0,s.A)((0,a.A)().m(function n(){var i,l,s,o,r,t,c,u,f,p,x,g,j,N,E,S,k,Y,w,b,y,T,_,B,I,M,q,U;return(0,a.A)().w(function(n){while(1)switch(n.p=n.n){case 0:if(d().showLoading({title:"\u767b\u5f55\u4e2d..."}),n.p=1,s="undefined"!==typeof d()?d().getEnv():"","h5"!==s){n.n=2;break}o="dev_h5_mock",n.n=4;break;case 2:return n.n=3,d().login();case 3:r=n.v,o=(null===r||void 0===r?void 0:r.code)||"";case 4:if(o){n.n=5;break}return d().hideLoading(),d().showToast({title:"\u83b7\u53d6\u767b\u5f55\u51ed\u8bc1\u5931\u8d25",icon:"none"}),n.a(2);case 5:return n.n=6,d().request({url:"".concat(m.env.apiBaseUrl,"/users/login"),method:"POST",header:{"Content-Type":"application/json"},data:{code:o}});case 6:t=n.v,d().hideLoading(),c=t.data,u=null!==(i=null===c||void 0===c?void 0:c.data)&&void 0!==i?i:c,f=null!==(l=null===u||void 0===u?void 0:u.access_token)&&void 0!==l?l:null===u||void 0===u?void 0:u.token,p=null===u||void 0===u?void 0:u.user_id,x=t.statusCode>=200&&t.statusCode<300,f&&null!=p&&x?((0,h.setAuthToken)(f,String(p)),e((0,v.iA)({userId:p,openid:null!==(g=null===u||void 0===u?void 0:u.openid)&&void 0!==g?g:"",nickname:null!==(j=null===u||void 0===u?void 0:u.nickname)&&void 0!==j?j:"\u88c5\u4fee\u7528\u6237",avatarUrl:null!==(N=null===u||void 0===u?void 0:u.avatar_url)&&void 0!==N?N:"",phone:"",phoneVerified:!1,isMember:null!==(E=null===u||void 0===u?void 0:u.is_member)&&void 0!==E&&E,points:null!==(S=null===u||void 0===u?void 0:u.points)&&void 0!==S?S:0})),d().showToast({title:"\u767b\u5f55\u6210\u529f",icon:"success"}),C(f,String(p)),A(f,String(p))):(w=null!==c&&void 0!==c?c:null===t||void 0===t?void 0:t.data,b=null!==(k=null!==(Y=null===w||void 0===w?void 0:w.detail)&&void 0!==Y?Y:null===w||void 0===w?void 0:w.msg)&&void 0!==k?k:"string"===typeof w?w:"\u767b\u5f55\u5931\u8d25",d().showToast({title:"string"===typeof b?b:"\u767b\u5f55\u5931\u8d25",icon:"none",duration:3e3})),n.n=8;break;case 7:n.p=7,U=n.v,d().hideLoading(),q=null!==(y=null!==(T=null!==(_=null!==(B=null===U||void 0===U||null===(I=U.data)||void 0===I?void 0:I.detail)&&void 0!==B?B:null===U||void 0===U||null===(M=U.data)||void 0===M?void 0:M.msg)&&void 0!==_?_:null===U||void 0===U?void 0:U.errMsg)&&void 0!==T?T:null===U||void 0===U?void 0:U.message)&&void 0!==y?y:"\u767b\u5f55\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5\u7f51\u7edc\u6216\u540e\u7aef",d().showToast({title:"string"===typeof q?q:"\u767b\u5f55\u5931\u8d25",icon:"none",duration:3e3});case 8:return n.a(2)}},n,null,[[1,7]])}));return function(){return n.apply(this,arguments)}}(),_=function(){d().showModal({title:"\u9000\u51fa\u767b\u5f55",content:"\u786e\u5b9a\u8981\u9000\u51fa\u767b\u5f55\u5417\uff1f",success:function(n){n.confirm&&((0,h.clearAuthToken)(),e((0,v.ri)()),x(0),N(0),k(0),d().showToast({title:"\u5df2\u9000\u51fa\u767b\u5f55",icon:"success"}))}})},B=function(e){return(0,f.EH)(e)};return(0,p.jsx)(t.BM,{scrollY:!0,className:"profile-page-outer",children:(0,p.jsxs)(t.Ss,{className:"profile-page",children:[(0,p.jsxs)(t.Ss,{className:"header-banner",children:[(0,p.jsx)(t.EY,{className:"my-equity",onClick:function(){return B("/pages/membership/index")},children:"\u6211\u7684\u6743\u76ca"}),i?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(t.Ss,{className:"avatar-wrap",onClick:function(){var e;return null===(e=d().getUserProfile)||void 0===e?void 0:e.call(d(),{desc:"\u7528\u4e8e\u5c55\u793a"}).then(function(){}).catch(function(){})},children:(0,p.jsx)(t.EY,{className:"avatar-placeholder",children:"\ud83d\udc64"})}),(0,p.jsx)(t.EY,{className:"nickname",children:(null===n||void 0===n?void 0:n.nickname)||"\u88c5\u4fee\u7528\u6237"}),(0,p.jsx)(t.Ss,{className:"member-badge",children:null!==n&&void 0!==n&&n.isMember?n.memberExpire?function(){var e=n.memberExpire,i=new Date(e),l=Math.ceil((i.getTime()-Date.now())/864e5),a="";return l<0?a="\uff08\u5df2\u8fc7\u671f\uff0c\u8bf7\u7eed\u8d39\uff09":l<=7&&(a="\uff08\u5373\u5c06\u5230\u671f\uff0c\u8bf7\u7eed\u8d39\uff09"),"\u4f1a\u5458\u6709\u6548\u671f\u81f3 ".concat(e).concat(a)}():"6\u5927\u9636\u6bb5\u5168\u89e3\u9501\u4f1a\u5458":"\u666e\u901a\u7528\u6237"}),void 0!==(null===n||void 0===n?void 0:n.points)&&(0,p.jsxs)(t.Ss,{className:"points-badge",onClick:function(){return B("/pages/points/index")},children:[(0,p.jsx)(t.EY,{className:"points-label",children:"\u79ef\u5206"}),(0,p.jsx)(t.EY,{className:"points-value",children:n.points})]})]}):(0,p.jsxs)(t.Ss,{className:"login-cta",children:[(0,p.jsx)(t.EY,{className:"avatar-placeholder",children:"\ud83d\udc64"}),(0,p.jsx)(t.EY,{className:"login-text",children:"\u767b\u5f55\u540e\u67e5\u770b\u66f4\u591a\u4fe1\u606f"}),(0,p.jsx)(t.Ss,{className:"login-btn",onClick:T,children:(0,p.jsx)(t.EY,{children:"\u7acb\u5373\u767b\u5f55"})})]})]}),(0,p.jsxs)(t.Ss,{className:"section",children:[(0,p.jsxs)(t.Ss,{className:"folder-item",onClick:function(){return B("/pages/data-manage/index?tab=report")},children:[(0,p.jsx)(t.EY,{className:"folder-icon",children:"\ud83d\udcc1"}),(0,p.jsx)(t.EY,{className:"folder-name",children:"\u6211\u7684\u6570\u636e"}),(0,p.jsx)(t.EY,{className:"folder-desc",children:"\u62a5\u544a/\u7167\u7247\u7ba1\u7406"}),(0,p.jsx)(t.EY,{className:"arrow",children:"\u203a"})]}),(0,p.jsxs)(t.Ss,{className:"folder-item",onClick:function(){return B("/pages/order-list/index")},children:[(0,p.jsx)(t.EY,{className:"folder-icon",children:"\ud83d\udce6"}),(0,p.jsx)(t.EY,{className:"folder-name",children:"\u6211\u7684\u8ba2\u5355"}),(0,p.jsx)(t.EY,{className:"arrow",children:"\u203a"})]}),(0,p.jsxs)(t.Ss,{className:"folder-item",onClick:function(){return B("/pages/calendar/index")},children:[(0,p.jsx)(t.EY,{className:"folder-icon",children:"\ud83d\udcc5"}),(0,p.jsx)(t.EY,{className:"folder-name",children:"\u88c5\u4fee\u65e5\u5386"}),(0,p.jsx)(t.EY,{className:"arrow",children:"\u203a"})]}),(0,p.jsxs)(t.Ss,{className:"folder-item",onClick:function(){return B("/pages/contact/index")},children:[(0,p.jsx)(t.EY,{className:"folder-icon",children:"\ud83d\udcde"}),(0,p.jsx)(t.EY,{className:"folder-name",children:"\u4e13\u5c5e\u5ba2\u670d"}),(0,p.jsx)(t.EY,{className:"arrow",children:"\u203a"})]})]}),(0,p.jsxs)(t.Ss,{className:"section",children:[(0,p.jsxs)(t.Ss,{className:"folder-item",onClick:function(){return B("/pages/account-notify/index")},children:[(0,p.jsx)(t.EY,{className:"folder-icon",children:"\u2699\ufe0f"}),(0,p.jsx)(t.EY,{className:"folder-name",children:"\u8d26\u6237\u4e0e\u901a\u77e5\u8bbe\u7f6e"}),(0,p.jsx)(t.EY,{className:"arrow",children:"\u203a"})]}),(0,p.jsxs)(t.Ss,{className:"folder-item",onClick:function(){return B("/pages/privacy/index")},children:[(0,p.jsx)(t.EY,{className:"folder-icon",children:"\ud83d\udd12"}),(0,p.jsx)(t.EY,{className:"folder-name",children:"\u9690\u79c1\u4fdd\u969c"}),(0,p.jsx)(t.EY,{className:"arrow",children:"\u203a"})]}),(0,p.jsxs)(t.Ss,{className:"folder-item",onClick:function(){return B("/pages/guide/index")},children:[(0,p.jsx)(t.EY,{className:"folder-icon",children:"\ud83d\udcd6"}),(0,p.jsx)(t.EY,{className:"folder-name",children:"\u4f7f\u7528\u6307\u5357"}),(0,p.jsx)(t.EY,{className:"arrow",children:"\u203a"})]}),(0,p.jsxs)(t.Ss,{className:"folder-item",onClick:function(){return B("/pages/about/index")},children:[(0,p.jsx)(t.EY,{className:"folder-icon",children:"\u2139\ufe0f"}),(0,p.jsx)(t.EY,{className:"folder-name",children:"\u5173\u4e8e&\u5e2e\u52a9"}),(0,p.jsx)(t.EY,{className:"arrow",children:"\u203a"})]}),(0,p.jsxs)(t.Ss,{className:"folder-item",onClick:function(){return B("/pages/feedback/index")},children:[(0,p.jsx)(t.EY,{className:"folder-icon",children:"\ud83d\udcac"}),(0,p.jsx)(t.EY,{className:"folder-name",children:"\u610f\u89c1\u53cd\u9988"}),(0,p.jsx)(t.EY,{className:"arrow",children:"\u203a"})]})]}),i&&(0,p.jsx)(t.Ss,{className:"logout-section",children:(0,p.jsx)(t.Ss,{className:"logout-btn",onClick:_,children:(0,p.jsx)(t.EY,{children:"\u9000\u51fa\u767b\u5f55"})})}),(0,p.jsx)(t.Ss,{className:"version-info",children:(0,p.jsx)(t.EY,{children:"\u7248\u672c 2.1.0"})})]})})},g=x,j={navigationBarTitleText:"\u6211\u7684",navigationBarBackgroundColor:"#1677FF",navigationBarTextStyle:"white",enablePullDownRefresh:!0};Page((0,l.createPageConfig)(g,"pages/profile/index",{root:{cn:[]}},j||{}))}},function(e){var n=function(n){return e(e.s=n)};e.O(0,[6907,8096,2076],function(){return n(2579)});e.O()}]);