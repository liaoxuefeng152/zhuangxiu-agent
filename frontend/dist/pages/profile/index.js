"use strict";(wx["webpackJsonp"]=wx["webpackJsonp"]||[]).push([[5862],{2579:function(e,n,l){var i=l(7842),a=l(1212),s=l(467),r=l(5544),o=l(6540),c=l(118),t=l(758),d=l.n(t),u=l(215),v=l(4532),m=l(3),h=l(4746),f=l(1281),x=l(4848),p=function(){var e=(0,u.j)(),n=(0,u.G)(function(e){return e.user.userInfo}),l=(0,u.G)(function(e){return e.user.isLoggedIn}),i=(0,o.useState)(0),t=(0,r.A)(i,2),p=(t[0],t[1]),g=(0,o.useState)(0),j=(0,r.A)(g,2),N=(j[0],j[1]),E=(0,o.useState)(0),S=(0,r.A)(E,2),k=(S[0],S[1]),Y=(0,o.useState)([]),w=(0,r.A)(Y,2),b=(w[0],w[1],m.env.apiBaseUrl),y=function(e,n){return{Authorization:"Bearer ".concat(e),"X-User-Id":String(n),"Content-Type":"application/json"}},A=function(){var n=(0,s.A)((0,a.A)().m(function n(l,i){var s,r,o,c,t,u,m,h,f,x,p,g,j,N,E,S,k,Y,w,A;return(0,a.A)().w(function(n){while(1)switch(n.p=n.n){case 0:if(r=null!==(s=null!==l&&void 0!==l?l:d().getStorageSync("token"))&&void 0!==s?s:d().getStorageSync("access_token"),o=null!==i&&void 0!==i?i:d().getStorageSync("user_id"),r){n.n=1;break}return n.a(2);case 1:return n.p=1,n.n=2,d().request({url:"".concat(b,"/users/profile"),method:"GET",header:y(r,null!=o?String(o):"")});case 2:m=n.v,h=null!==(c=null===(t=m.data)||void 0===t?void 0:t.data)&&void 0!==c?c:m.data,f=h,f&&(null!==(u=f.user_id)&&void 0!==u?u:f.userId)&&(w=f.member_expire,A=w?"string"===typeof w?w.slice(0,10):new Date(w).toISOString().slice(0,10):void 0,e((0,v.iA)({userId:null!==(x=f.user_id)&&void 0!==x?x:f.userId,openid:null!==(p=f.openid)&&void 0!==p?p:"",nickname:null!==(g=f.nickname)&&void 0!==g?g:"\u88c5\u4fee\u7528\u6237",avatarUrl:null!==(j=null!==(N=f.avatar_url)&&void 0!==N?N:f.avatarUrl)&&void 0!==j?j:"",phone:null!==(E=f.phone)&&void 0!==E?E:"",phoneVerified:null!==(S=f.phone_verified)&&void 0!==S&&S,isMember:null!==(k=null!==(Y=f.is_member)&&void 0!==Y?Y:f.isMember)&&void 0!==k&&k,memberExpire:A}))),n.n=4;break;case 3:n.p=3,n.v;case 4:return n.a(2)}},n,null,[[1,3]])}));return function(e,l){return n.apply(this,arguments)}}(),C=function(){var e=(0,s.A)((0,a.A)().m(function e(n,l){var i,s,o,c,t,u,v,m,h,f,x,g;return(0,a.A)().w(function(e){while(1)switch(e.p=e.n){case 0:if(s=null!==(i=null!==n&&void 0!==n?n:d().getStorageSync("token"))&&void 0!==i?i:d().getStorageSync("access_token"),o=null!==l&&void 0!==l?l:d().getStorageSync("user_id"),s){e.n=1;break}return e.a(2);case 1:return e.p=1,v=y(s,null!=o?String(o):""),e.n=2,Promise.all([d().request({url:"".concat(b,"/companies/scans"),method:"GET",header:v}).then(function(e){var n,l,i;return null!==(n=null!==(l=null===(i=e.data)||void 0===i?void 0:i.data)&&void 0!==l?l:e.data)&&void 0!==n?n:{}}),d().request({url:"".concat(b,"/quotes/list"),method:"GET",header:v}).then(function(e){var n,l,i;return null!==(n=null!==(l=null===(i=e.data)||void 0===i?void 0:i.data)&&void 0!==l?l:e.data)&&void 0!==n?n:{}}),d().request({url:"".concat(b,"/contracts/list"),method:"GET",header:v}).then(function(e){var n,l,i;return null!==(n=null!==(l=null===(i=e.data)||void 0===i?void 0:i.data)&&void 0!==l?l:e.data)&&void 0!==n?n:{}})]);case 2:m=e.v,h=(0,r.A)(m,3),f=h[0],x=h[1],g=h[2],p(null!==(c=null===f||void 0===f?void 0:f.total)&&void 0!==c?c:0),N(null!==(t=null===x||void 0===x?void 0:x.total)&&void 0!==t?t:0),k(null!==(u=null===g||void 0===g?void 0:g.total)&&void 0!==u?u:0),e.n=4;break;case 3:e.p=3,e.v,p(0),N(0),k(0);case 4:return e.a(2)}},e,null,[[1,3]])}));return function(n,l){return e.apply(this,arguments)}}();(0,o.useEffect)(function(){l&&(A(),C())},[l]);var T=function(){var n=(0,s.A)((0,a.A)().m(function n(){var l,i,s,r,o,c,t,u,f,x,p,g,j,N,E,S,k,Y,w,b,y,T,_,B,I,M,q;return(0,a.A)().w(function(n){while(1)switch(n.p=n.n){case 0:if(d().showLoading({title:"\u767b\u5f55\u4e2d..."}),n.p=1,s="undefined"!==typeof d()?d().getEnv():"","h5"!==s){n.n=2;break}r="dev_h5_mock",n.n=4;break;case 2:return n.n=3,d().login();case 3:o=n.v,r=(null===o||void 0===o?void 0:o.code)||"";case 4:if(r){n.n=5;break}return d().hideLoading(),d().showToast({title:"\u83b7\u53d6\u767b\u5f55\u51ed\u8bc1\u5931\u8d25",icon:"none"}),n.a(2);case 5:return n.n=6,d().request({url:"".concat(m.env.apiBaseUrl,"/users/login"),method:"POST",header:{"Content-Type":"application/json"},data:{code:r}});case 6:c=n.v,d().hideLoading(),t=c.data,u=null!==(l=null===t||void 0===t?void 0:t.data)&&void 0!==l?l:t,f=null!==(i=null===u||void 0===u?void 0:u.access_token)&&void 0!==i?i:null===u||void 0===u?void 0:u.token,x=null===u||void 0===u?void 0:u.user_id,p=c.statusCode>=200&&c.statusCode<300,f&&null!=x&&p?((0,h.setAuthToken)(f,String(x)),e((0,v.iA)({userId:x,openid:null!==(g=null===u||void 0===u?void 0:u.openid)&&void 0!==g?g:"",nickname:null!==(j=null===u||void 0===u?void 0:u.nickname)&&void 0!==j?j:"\u88c5\u4fee\u7528\u6237",avatarUrl:null!==(N=null===u||void 0===u?void 0:u.avatar_url)&&void 0!==N?N:"",phone:"",phoneVerified:!1,isMember:null!==(E=null===u||void 0===u?void 0:u.is_member)&&void 0!==E&&E})),d().showToast({title:"\u767b\u5f55\u6210\u529f",icon:"success"}),A(f,String(x)),C(f,String(x))):(Y=null!==t&&void 0!==t?t:null===c||void 0===c?void 0:c.data,w=null!==(S=null!==(k=null===Y||void 0===Y?void 0:Y.detail)&&void 0!==k?k:null===Y||void 0===Y?void 0:Y.msg)&&void 0!==S?S:"string"===typeof Y?Y:"\u767b\u5f55\u5931\u8d25",d().showToast({title:"string"===typeof w?w:"\u767b\u5f55\u5931\u8d25",icon:"none",duration:3e3})),n.n=8;break;case 7:n.p=7,q=n.v,d().hideLoading(),M=null!==(b=null!==(y=null!==(T=null!==(_=null===q||void 0===q||null===(B=q.data)||void 0===B?void 0:B.detail)&&void 0!==_?_:null===q||void 0===q||null===(I=q.data)||void 0===I?void 0:I.msg)&&void 0!==T?T:null===q||void 0===q?void 0:q.errMsg)&&void 0!==y?y:null===q||void 0===q?void 0:q.message)&&void 0!==b?b:"\u767b\u5f55\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5\u7f51\u7edc\u6216\u540e\u7aef",d().showToast({title:"string"===typeof M?M:"\u767b\u5f55\u5931\u8d25",icon:"none",duration:3e3});case 8:return n.a(2)}},n,null,[[1,7]])}));return function(){return n.apply(this,arguments)}}(),_=function(){d().showModal({title:"\u9000\u51fa\u767b\u5f55",content:"\u786e\u5b9a\u8981\u9000\u51fa\u767b\u5f55\u5417\uff1f",success:function(n){n.confirm&&((0,h.clearAuthToken)(),e((0,v.ri)()),p(0),N(0),k(0),d().showToast({title:"\u5df2\u9000\u51fa\u767b\u5f55",icon:"success"}))}})},B=function(e){return(0,f.EH)(e)};return(0,x.jsx)(c.BM,{scrollY:!0,className:"profile-page-outer",children:(0,x.jsxs)(c.Ss,{className:"profile-page",children:[(0,x.jsxs)(c.Ss,{className:"header-banner",children:[(0,x.jsx)(c.EY,{className:"my-equity",onClick:function(){return B("/pages/membership/index")},children:"\u6211\u7684\u6743\u76ca"}),l?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(c.Ss,{className:"avatar-wrap",onClick:function(){var e;return null===(e=d().getUserProfile)||void 0===e?void 0:e.call(d(),{desc:"\u7528\u4e8e\u5c55\u793a"}).then(function(){}).catch(function(){})},children:(0,x.jsx)(c.EY,{className:"avatar-placeholder",children:"\ud83d\udc64"})}),(0,x.jsx)(c.EY,{className:"nickname",children:(null===n||void 0===n?void 0:n.nickname)||"\u88c5\u4fee\u7528\u6237"}),(0,x.jsx)(c.Ss,{className:"member-badge",children:null!==n&&void 0!==n&&n.isMember?n.memberExpire?function(){var e=n.memberExpire,l=new Date(e),i=Math.ceil((l.getTime()-Date.now())/864e5),a="";return i<0?a="\uff08\u5df2\u8fc7\u671f\uff0c\u8bf7\u7eed\u8d39\uff09":i<=7&&(a="\uff08\u5373\u5c06\u5230\u671f\uff0c\u8bf7\u7eed\u8d39\uff09"),"\u4f1a\u5458\u6709\u6548\u671f\u81f3 ".concat(e).concat(a)}():"6\u5927\u9636\u6bb5\u5168\u89e3\u9501\u4f1a\u5458":"\u666e\u901a\u7528\u6237"})]}):(0,x.jsxs)(c.Ss,{className:"login-cta",children:[(0,x.jsx)(c.EY,{className:"avatar-placeholder",children:"\ud83d\udc64"}),(0,x.jsx)(c.EY,{className:"login-text",children:"\u767b\u5f55\u540e\u67e5\u770b\u66f4\u591a\u4fe1\u606f"}),(0,x.jsx)(c.Ss,{className:"login-btn",onClick:T,children:(0,x.jsx)(c.EY,{children:"\u7acb\u5373\u767b\u5f55"})})]})]}),(0,x.jsxs)(c.Ss,{className:"section",children:[(0,x.jsxs)(c.Ss,{className:"folder-item",onClick:function(){return B("/pages/data-manage/index?tab=report")},children:[(0,x.jsx)(c.EY,{className:"folder-icon",children:"\ud83d\udcc1"}),(0,x.jsx)(c.EY,{className:"folder-name",children:"\u6211\u7684\u6570\u636e"}),(0,x.jsx)(c.EY,{className:"folder-desc",children:"\u62a5\u544a/\u7167\u7247\u7ba1\u7406"}),(0,x.jsx)(c.EY,{className:"arrow",children:"\u203a"})]}),(0,x.jsxs)(c.Ss,{className:"folder-item",onClick:function(){return B("/pages/order-list/index")},children:[(0,x.jsx)(c.EY,{className:"folder-icon",children:"\ud83d\udce6"}),(0,x.jsx)(c.EY,{className:"folder-name",children:"\u6211\u7684\u8ba2\u5355"}),(0,x.jsx)(c.EY,{className:"arrow",children:"\u203a"})]}),(0,x.jsxs)(c.Ss,{className:"folder-item",onClick:function(){return B("/pages/calendar/index")},children:[(0,x.jsx)(c.EY,{className:"folder-icon",children:"\ud83d\udcc5"}),(0,x.jsx)(c.EY,{className:"folder-name",children:"\u88c5\u4fee\u65e5\u5386"}),(0,x.jsx)(c.EY,{className:"arrow",children:"\u203a"})]}),(0,x.jsxs)(c.Ss,{className:"folder-item",onClick:function(){return B("/pages/contact/index")},children:[(0,x.jsx)(c.EY,{className:"folder-icon",children:"\ud83d\udcde"}),(0,x.jsx)(c.EY,{className:"folder-name",children:"\u4e13\u5c5e\u5ba2\u670d"}),(0,x.jsx)(c.EY,{className:"arrow",children:"\u203a"})]})]}),(0,x.jsxs)(c.Ss,{className:"section",children:[(0,x.jsxs)(c.Ss,{className:"folder-item",onClick:function(){return B("/pages/account-notify/index")},children:[(0,x.jsx)(c.EY,{className:"folder-icon",children:"\u2699\ufe0f"}),(0,x.jsx)(c.EY,{className:"folder-name",children:"\u8d26\u6237\u4e0e\u901a\u77e5\u8bbe\u7f6e"}),(0,x.jsx)(c.EY,{className:"arrow",children:"\u203a"})]}),(0,x.jsxs)(c.Ss,{className:"folder-item",onClick:function(){return B("/pages/privacy/index")},children:[(0,x.jsx)(c.EY,{className:"folder-icon",children:"\ud83d\udd12"}),(0,x.jsx)(c.EY,{className:"folder-name",children:"\u9690\u79c1\u4fdd\u969c"}),(0,x.jsx)(c.EY,{className:"arrow",children:"\u203a"})]}),(0,x.jsxs)(c.Ss,{className:"folder-item",onClick:function(){return B("/pages/guide/index")},children:[(0,x.jsx)(c.EY,{className:"folder-icon",children:"\ud83d\udcd6"}),(0,x.jsx)(c.EY,{className:"folder-name",children:"\u4f7f\u7528\u6307\u5357"}),(0,x.jsx)(c.EY,{className:"arrow",children:"\u203a"})]}),(0,x.jsxs)(c.Ss,{className:"folder-item",onClick:function(){return B("/pages/about/index")},children:[(0,x.jsx)(c.EY,{className:"folder-icon",children:"\u2139\ufe0f"}),(0,x.jsx)(c.EY,{className:"folder-name",children:"\u5173\u4e8e&\u5e2e\u52a9"}),(0,x.jsx)(c.EY,{className:"arrow",children:"\u203a"})]}),(0,x.jsxs)(c.Ss,{className:"folder-item",onClick:function(){return B("/pages/feedback/index")},children:[(0,x.jsx)(c.EY,{className:"folder-icon",children:"\ud83d\udcac"}),(0,x.jsx)(c.EY,{className:"folder-name",children:"\u610f\u89c1\u53cd\u9988"}),(0,x.jsx)(c.EY,{className:"arrow",children:"\u203a"})]})]}),l&&(0,x.jsx)(c.Ss,{className:"logout-section",children:(0,x.jsx)(c.Ss,{className:"logout-btn",onClick:_,children:(0,x.jsx)(c.EY,{children:"\u9000\u51fa\u767b\u5f55"})})}),(0,x.jsx)(c.Ss,{className:"version-info",children:(0,x.jsx)(c.EY,{children:"\u7248\u672c 2.1.0"})})]})})},g=p,j={navigationBarTitleText:"\u6211\u7684",navigationBarBackgroundColor:"#1677FF",navigationBarTextStyle:"white",enablePullDownRefresh:!0};Page((0,i.createPageConfig)(g,"pages/profile/index",{root:{cn:[]}},j||{}))}},function(e){var n=function(n){return e(e.s=n)};e.O(0,[6907,8096,2076],function(){return n(2579)});e.O()}]);