# 快速部署说明

## 方式一：直接在服务器上部署（推荐）

如果你已经通过SSH连接到阿里云服务器，直接在服务器上执行：

```bash
# 1. 进入项目目录
cd /path/to/zhuangxiu-agent

# 2. 执行部署脚本
./scripts/deploy-aliyun.sh dev
```

## 方式二：从本地通过SSH远程部署

如果你在本地机器上，想通过SSH连接到服务器并部署：

```bash
# 1. 确保已配置SSH密钥认证
# 2. 执行远程部署脚本
./scripts/deploy-remote-dev.sh root@your-server-ip

# 示例
./scripts/deploy-remote-dev.sh root@120.26.201.61
```

## 方式三：手动执行步骤

如果脚本无法使用，可以手动执行：

```bash
# 1. SSH连接到服务器
ssh root@your-server-ip

# 2. 进入项目目录
cd /path/to/zhuangxiu-agent

# 3. 停止现有容器
docker-compose -f docker-compose.server-dev.yml down

# 4. 构建镜像
docker-compose -f docker-compose.server-dev.yml build --no-cache backend

# 5. 启动服务
docker-compose -f docker-compose.server-dev.yml up -d

# 6. 查看日志
docker-compose -f docker-compose.server-dev.yml logs -f backend

# 7. 检查健康状态
curl http://localhost:8001/health
```

## 仅重启服务（不重新构建）

```bash
# 在服务器上执行
./scripts/restart-backend.sh dev

# 或手动执行
docker-compose -f docker-compose.server-dev.yml restart backend
```

## 注意事项

1. **确保Docker已安装并运行**
   ```bash
   docker --version
   docker-compose --version
   ```

2. **确保.env文件已配置**
   ```bash
   ls -la .env
   ```

3. **检查端口是否被占用**
   ```bash
   netstat -tulpn | grep 8001
   ```

4. **查看服务状态**
   ```bash
   docker-compose -f docker-compose.server-dev.yml ps
   ```

5. **查看日志排查问题**
   ```bash
   docker-compose -f docker-compose.server-dev.yml logs -f backend
   ```

## 常见问题

### Docker未运行
```bash
# 启动Docker服务
sudo systemctl start docker
# 或
sudo service docker start
```

### 权限问题
```bash
# 添加用户到docker组
sudo usermod -aG docker $USER
# 重新登录后生效
```

### 端口被占用
```bash
# 查找占用端口的进程
lsof -i :8001
# 或修改 docker-compose.server-dev.yml 中的端口映射
```
