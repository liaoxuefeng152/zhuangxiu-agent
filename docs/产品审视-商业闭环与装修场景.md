# 装修避坑管家 - 产品审视报告（商业闭环与装修场景）

**视角**：懂装修的产品经理  
**重点**：商业闭环、付费落地、装修场景合理性  
**日期**：2026-02-12

---

## 一、商业闭环总览

理想闭环：**获客 → 体验价值 → 付费 → 订单/权益落地 → 复购/会员/转介绍**。

| 环节     | 当前状态 | 主要问题 |
|----------|----------|----------|
| 获客     | ✅ 有    | 小程序、首页、引导页、城市定位 |
| 体验价值 | ✅ 有    | 公司检测、报价/合同分析、施工陪伴、验收、AI监理 |
| 付费触点 | ✅ 有    | 解锁页、会员页、监理页 |
| **付费落地** | ❌ **断链** | 见下节 |
| 订单/权益 | ⚠️ 半断 | 依赖前端 storage，无真实订单与支付回调 |
| 复购/升级 | ❌ 弱    | 无「单次解锁后推会员」、无会员续费提醒 |
| 转介绍   | ⚠️ 有入口无激励 | 分享页有，无邀请奖励或裂变设计 |

---

## 二、付费落地断链（最严重）

### 2.1 报告解锁：未走真实支付与订单

- **现状**：用户点击「解锁本份报告 ￥9.9」→ 进入支付页 → 点「立即解锁」→ 前端仅执行 `Taro.setStorageSync('report_unlocked_xxx', true)`，然后跳转报告详情。
- **问题**：
  1. **未创建订单**：未调用后端 `POST /payments/create`（前端已有 `api.createOrder` 但未使用）。
  2. **未发起支付**：未调用 `POST /payments/pay` 获取微信支付参数，未调起微信支付。
  3. **权益仅存前端**：解锁状态只在前端 storage，换设备、清缓存、重装即丢失；后端 `Quote/Contract.is_unlocked` 与前端不同步。
  4. **订单列表无记录**：我的订单里不会出现「报告解锁」订单，用户无支付凭证，也无法做售后/退款。

**产品结论**：报告解锁的「收钱」环节未接通，商业闭环在付费这一步断开。

### 2.2 会员开通：未接通订单与支付

- **现状**：会员页选择月/季/年卡 → 跳转支付页带 `pkg=member_month&amount=29.9` 等 → 支付页仍展示「单份/3份报告」选择 + 「立即解锁」按钮，点击后执行的仍是**报告解锁**的 storage 逻辑，没有会员开通、没有订单、没有支付。
- **问题**：
  1. 支付页未区分「报告解锁」与「会员购买」；会员金额（29.9/69.9/199）未展示。
  2. 未调用创建会员订单、未调起微信支付、未在支付成功后更新用户 `is_member` 与到期时间。

**产品结论**：会员是拉高 LTV 的核心，但目前无法真实收款与开通。

### 2.3 监理服务：仅前端确认，无订单与支付

- **现状**：监理页（单次 99/全流程 3 次 268）点「立即支付」→ 弹窗确认 → Toast「唤起支付...」→ 返回上一页，无订单创建、无支付调起。
- **问题**：与报告解锁类似，没有和 `/payments/create`、`/payments/pay` 对接，无法形成真实交易与履约。

### 2.4 后端能力与前端未对接

- 后端已具备：创建订单（含报告单份/套餐、监理单次/套餐）、会员免费解锁逻辑、`pay_order` 生成支付参数、支付回调骨架。
- 前端未使用：报告解锁/会员/监理均未调用上述接口，支付页未根据场景（报告/会员/订单支付）分支处理。

**建议（优先级 P0）**：  
1. **报告解锁**：从解锁页/支付页 → 先调 `createOrder`（resource_type=quote/contract/company, resource_id=xxx）→ 再调 `pay_order` 调起微信支付 → 支付成功后由回调或轮询更新订单状态，并同步后端 `is_unlocked`；前端以「订单已支付」或后端返回的 `is_unlocked` 为准，而非仅 storage。  
2. **会员**：支付页识别 `pkg=member_*` 时，展示会员套餐与金额，创建会员订单并调起支付，支付成功后更新 `users.is_member`、到期时间，并同步前端。  
3. **监理**：同上，创建监理订单并调起支付，支付成功后可预约/履约。

---

## 三、解锁与后端「首次免费」不同步

- **后端**：报价单/合同分析完成时，若用户没有其他已解锁报告，会置 `is_unlocked=True, unlock_type='first_free'`（PRD 首次报告免费）。
- **前端**：报告详情页是否解锁只看 `Taro.getStorageSync('report_unlocked_${type}_${scanId}')`，**不读后端** `is_unlocked`。
- **结果**：首次免费在服务端已生效，但用户换设备或清缓存后，前端仍显示未解锁；或反之，前端 storage 被清掉后即使用户已付费/首次免费，也会再次被要求付费。
- **建议**：报告详情/导出前，应优先以接口返回的 `is_unlocked` 为准（列表/详情接口已带该字段），storage 仅作缓存；未登录时再回退到 storage 或提示登录后同步权益。

---

## 四、装修场景下的产品与流程问题

### 4.1 公司检测未参与「首次免费」

- 报价单、合同有首次免费逻辑；公司检测（CompanyScan）未看到类似 `first_free` 或自动解锁逻辑。
- 若产品希望「首次使用任一功能即送一份完整报告」，建议公司检测也纳入：例如用户无任何已解锁报告时，首条公司检测报告自动视为已解锁。

### 4.2 验收报告与施工进度的联动

- 验收报告解锁后，若从验收页进入，应能直接看完整报告/PDF，且与施工陪伴的「阶段完成」状态一致。
- 需确认：验收阶段与报告解锁的 `stage`、`scanId` 与后端 construction/acceptance 数据是否一一对应，避免「已解锁但看不到」或「阶段未完成却可解锁」等错位。

### 4.3 施工节奏与付费节奏

- 装修周期长，用户可能在「签合同前」集中用报价+合同分析，在「施工中」才用验收与监理。
- 建议在**关键决策点**强化付费与会员价值：
  - 报价/合同分析结果页：明确「发现 X 个风险，解锁完整报告可省约 XXX 元」+ 会员「全报告免费」对比。
  - 施工陪伴：首阶段或首次验收前，可轻量提示「开通会员可无限次验收+报告导出」，与单次解锁对比。

### 4.4 会员价值在端内表达不足

- 会员权益（无限报告、AI 监理无限次、数据恢复 30 天等）在会员页有列表，但在**报告解锁页、验收页**缺少对比：「单次 9.9 vs 会员 199/年 全包」的算账式文案不足，用户容易只做单次付费，难以形成「装修全周期用会员更划算」的认知。
- 建议：解锁页保留「解锁本份 ￥9.9」主按钮，下方增加一行「开通会员，所有报告+验收报告无限解锁 →」跳会员页，用价格对比强化会员价值。

---

## 五、复购、续费、转介绍

### 5.1 单次解锁 → 会员升级

- 用户已为单份报告付 9.9 后，没有「您已为报告付费，开通会员可解锁全部报告，更划算」的引导。
- 建议：在报告详情页（或支付成功页）若检测到用户有 1 次及以上单次解锁记录，展示「升级会员」入口或弹窗（可限频次）。

### 5.2 会员续费

- 会员到期前 7 天/3 天/到期日，若有消息或推送能力，应提醒续费；「我的」页会员状态需展示到期日，到期后权益回收与提示要明确。

### 5.3 转介绍

- 分享页（P32）存在，但无邀请奖励、拼团、或「分享得解锁次数」等设计，商业闭环的「拉新」环节偏弱；可后续设计邀请规则（如邀请 1 人得 1 次免费解锁等），并与风控、防刷结合。

---

## 六、其他产品与实现细节

### 6.1 支付页场景分支

- 当前支付页通过 `type+scanId` 判断「报告解锁」，其余为「其他」并展示单份/3 份；但来自会员页的 `pkg=member_*`、来自订单列表的 `order_id` 未单独处理。
- 建议：支付页按来源分支：
  - `type + scanId` → 报告解锁（仅单份 9.9，创建报告订单并支付）；
  - `pkg=member_*` + `amount` → 会员套餐（展示套餐名与金额，创建会员订单并支付）；
  - `order_id` → 订单支付（展示订单金额，调 pay_order 调起支付）。

### 6.2 微信支付未真正接通

- 后端 `pay_order` 返回的为示例结构（如 `prepay_id=订单号`），未对接微信支付统一下单与回调；支付回调注释掉了订单状态更新。
- 要形成真实商业闭环，必须接入微信支付：统一下单 → 前端调起支付 → 回调更新订单状态并同步权益（报告 is_unlocked、用户 is_member 等）。

### 6.3 订单列表与「去支付」

- 订单列表「待支付」的「去支付」跳转到支付页并带 `order_id`，但支付页未处理 `order_id`，无法完成「对已有订单发起支付」的闭环。
- 建议：支付页识别 `order_id` 时，只展示订单金额与「去支付」，调用 `pay_order(order_id)` 调起支付，不重复创建订单。

---

## 七、优先级建议（商业闭环视角）

| 优先级 | 事项 | 说明 |
|--------|------|------|
| **P0** | 报告解锁走真实订单+支付 | 创建订单 → 调起微信支付 → 回调/轮询更新状态，前端以后端 is_unlocked 为准 |
| **P0** | 会员开通走真实订单+支付 | 支付页识别会员套餐，创建会员订单并支付，成功后更新 is_member 与到期时间 |
| **P0** | 支付页按来源分支 | 报告解锁 / 会员 / 订单支付 三种场景分别展示与调用对应接口 |
| **P1** | 前端解锁状态与后端统一 | 报告详情/导出优先读接口 is_unlocked，storage 仅作缓存或未登录兜底 |
| **P1** | 公司检测首次免费 | 与报价/合同一致，首条公司报告自动解锁（若产品策略为「首次任一类报告免费」） |
| **P1** | 订单列表「去支付」 | 支付页支持 order_id，调 pay_order 完成待支付订单支付 |
| **P2** | 监理服务订单+支付 | 与报告解锁类似，创建监理订单并调起支付 |
| **P2** | 单次解锁后推会员 | 报告详情/支付成功页引导「升级会员更划算」 |
| **P2** | 会员续费提醒 | 到期前消息/推送 + 「我的」页到期日展示 |
| **P3** | 转介绍/邀请奖励 | 在分享基础上设计邀请规则并与防刷结合 |

---

## 八、小结

- **核心问题**：商业闭环在「付费」环节断开——报告解锁、会员、监理均未与后端订单和微信支付打通，权益依赖前端 storage，无法真实收款、无法跨端一致、无法做订单与售后。
- **装修场景**：价值与触点较清晰，需补足「首次免费」与后端解锁状态一致、在关键节点强化会员价值、以及单次→会员的升级路径。
- **建议**：优先打通「报告解锁」与「会员」的真实订单与支付，并统一前端与后端的解锁/会员状态；在此基础上再完善监理支付、订单去支付、复购与转介绍。

---

## 九、实现状态对照（截至 2026-02）

| 优先级 | 事项 | 状态 | 说明 |
|--------|------|------|------|
| **P0** | 报告解锁走真实订单+支付 | ✅ 已实现 | 支付页调用 createOrder → confirm-paid，后端更新 is_unlocked；开发/联调用 confirm-paid 模拟支付，生产需接微信回调 |
| **P0** | 会员开通走真实订单+支付 | ✅ 已实现 | 支付页识别 pkg=member_*，创建会员订单，confirm-paid 后更新 is_member、member_expire |
| **P0** | 支付页按来源分支 | ✅ 已实现 | 报告解锁 / 会员 / 订单支付（order_id）三种场景分别展示与调用 |
| **P1** | 前端解锁状态与后端统一 | ✅ 已实现 | 报告详情（合同/报价/公司）优先读接口 is_unlocked，storage 兜底 |
| **P1** | 公司检测首次免费 | ✅ 已实现 | 公司分析完成后若用户无任何已解锁报告，自动置 is_unlocked=True, unlock_type=first_free |
| **P1** | 订单列表「去支付」 | ✅ 已实现 | 支付页支持 order_id，调用 confirm-paid 完成待支付订单 |
| **P2** | 监理服务订单+支付 | ✅ 已实现 | 监理页创建 supervision_single/supervision_package 订单后跳转支付页，支付页 confirm-paid |
| **P2** | 单次解锁后推会员 | ✅ 已实现 | 报告详情页（已解锁时）展示「开通会员，全部报告无限解锁 →」；解锁页增加会员引导 |
| **P2** | 会员续费提醒 | ✅ 已实现 | 后端 profile 返回 member_expire；「我的」/会员页展示到期日，7 天内展示「即将到期，请续费」 |
| **P3** | 转介绍/邀请奖励 | ✅ 已实现 | 进度分享页增加「邀请好友得1次免费报告解锁」+ 复制邀请文案（奖励发放规则可后续对接） |
| — | 解锁页增加会员引导（4.4） | ✅ 已实现 | 解锁页主按钮下「开通会员，所有报告+验收报告无限解锁 →」跳会员页 |
| — | 微信支付回调（6.2） | ✅ 已实现 | POST /payments/notify 解析 out_trade_no，与 confirm_paid 共用权益发放逻辑；生产需验签与 XML 解析 |

**小结**：上述项均已实现；生产环境需接入微信统一下单与验签，邀请奖励发放可后续对接后端规则与防刷。

---

*文档可随实现进展更新优先级与完成状态。*
